<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.8">
  <title>
   dbp.io
  </title>
  <link rel="stylesheet" type="text/css" href="scribble.css" title="default">
  <link rel="stylesheet" type="text/css" href="minted.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-style.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-racket.css" title="default">
  <link rel="stylesheet" type="text/css" href="minted-default-style.css" title="default">
  <link rel="stylesheet" type="text/css" href="main.css" title="default">
  <script type="text/javascript" src="scribble-common.js"></script>
  <script type="text/javascript" src="manual-racket.js"></script>
 </head>
 <body id="scribble-racket-lang-org">
  <div class="tocset">
   <div class="tocview">
    <div class="tocviewlist tocviewlisttopspace">
     <div class="tocviewtitle">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td style="width: 1em;">
          <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a>
         </td>
         <td></td>
         <td>
          <a href="index.html" class="tocviewlink" data-pltdoc="x">Logic &amp; Computation</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
     <div class="tocviewsublisttop" style="display: none;" id="tocview_0">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="schedule.html" class="tocviewlink" data-pltdoc="x">Schedule</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lectures.html" class="tocviewselflink" data-pltdoc="x">Lectures</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="homework.html" class="tocviewlink" data-pltdoc="x">Homework</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="ref.html" class="tocviewlink" data-pltdoc="x">Lean Tactic Reference</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a>
        </td>
        <td></td>
        <td>
         <a href="lectures.html" class="tocviewlink" data-pltdoc="x">Lectures</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublist" style="display: block;" id="tocview_1">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l1.html" class="tocviewlink" data-pltdoc="x">Lecture 1:<span class="mywbr"> &nbsp;</span> Intro</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l2.html" class="tocviewlink" data-pltdoc="x">Lecture 2:<span class="mywbr"> &nbsp;</span> Logistics, Specifications in ISL</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l3.html" class="tocviewlink" data-pltdoc="x">Lecture 3:<span class="mywbr"> &nbsp;</span> Propositional Logic in Code</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l4.html" class="tocviewlink" data-pltdoc="x">Lecture 4:<span class="mywbr"> &nbsp;</span> Design /<span class="mywbr"> &nbsp;</span> Specification Recipe</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l5.html" class="tocviewlink" data-pltdoc="x">Lecture 5:<span class="mywbr"> &nbsp;</span> Relational Specifications</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l6.html" class="tocviewlink" data-pltdoc="x">Lecture 6:<span class="mywbr"> &nbsp;</span> For-<wbr>all, Intro to PBT</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l7.html" class="tocviewlink" data-pltdoc="x">Lecture 7:<span class="mywbr"> &nbsp;</span> ==&gt;, PBT filtering</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l8.html" class="tocviewlink" data-pltdoc="x">Lecture 8:<span class="mywbr"> &nbsp;</span> PBT generators</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l9.html" class="tocviewlink" data-pltdoc="x">Lecture 9:<span class="mywbr"> &nbsp;</span> SAT</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l10.html" class="tocviewlink" data-pltdoc="x">Lecture 10:<span class="mywbr"> &nbsp;</span> SMT &amp; Rosette</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l11.html" class="tocviewlink" data-pltdoc="x">Lecture 11:<span class="mywbr"> &nbsp;</span> Rosette &amp; Finitization</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l12.html" class="tocviewlink" data-pltdoc="x">Lecture 12:<span class="mywbr"> &nbsp;</span> Higher order logic</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l13.html" class="tocviewlink" data-pltdoc="x">Lecture 13:<span class="mywbr"> &nbsp;</span> Functions</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l14.html" class="tocviewlink" data-pltdoc="x">Lecture 14:<span class="mywbr"> &nbsp;</span> Propositional logic</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l15.html" class="tocviewlink" data-pltdoc="x">Lecture 15:<span class="mywbr"> &nbsp;</span> Propositional logic &amp; programming</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l16.html" class="tocviewlink" data-pltdoc="x">Lecture 16:<span class="mywbr"> &nbsp;</span> Exam 1, Part A</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l17.html" class="tocviewlink" data-pltdoc="x">Lecture 17:<span class="mywbr"> &nbsp;</span> Exam 1, Part B</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l18.html" class="tocviewlink" data-pltdoc="x">Lecture 18:<span class="mywbr"> &nbsp;</span> Proving with tactics</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l19.html" class="tocviewlink" data-pltdoc="x">Lecture 19:<span class="mywbr"> &nbsp;</span> Inductive types &amp; proofs</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l20.html" class="tocviewlink" data-pltdoc="x">Lecture 20:<span class="mywbr"> &nbsp;</span> Lists</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l21.html" class="tocviewlink" data-pltdoc="x">Lecture 21:<span class="mywbr"> &nbsp;</span>  Proof Practice</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l22.html" class="tocviewlink" data-pltdoc="x">Lecture 22:<span class="mywbr"> &nbsp;</span> Generalizing hypotheses</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l23.html" class="tocviewlink" data-pltdoc="x">Lecture 23:<span class="mywbr"> &nbsp;</span> Generalize</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l24.html" class="tocviewlink" data-pltdoc="x">Lecture 24:<span class="mywbr"> &nbsp;</span> Standard Libraries</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l25.html" class="tocviewlink" data-pltdoc="x">Lecture 25:<span class="mywbr"> &nbsp;</span> Forward Reasoning</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l26.html" class="tocviewlink" data-pltdoc="x">Lecture 26:<span class="mywbr"> &nbsp;</span> Proof Automation</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l27.html" class="tocviewlink" data-pltdoc="x">Lecture 27:<span class="mywbr"> &nbsp;</span> Compiler Correctness</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="" class="tocviewselflink" data-pltdoc="x">Lecture 28:<span class="mywbr"> &nbsp;</span> Induction</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l29.html" class="tocviewlink" data-pltdoc="x">Lecture 29:<span class="mywbr"> &nbsp;</span> Functions vs. Relations</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l30.html" class="tocviewlink" data-pltdoc="x">Lecture 30:<span class="mywbr"> &nbsp;</span> Why logic?</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l31.html" class="tocviewlink" data-pltdoc="x">Lecture 31:<span class="mywbr"> &nbsp;</span> Linear Logic</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l32.html" class="tocviewlink" data-pltdoc="x">Lecture 32</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l33.html" class="tocviewlink" data-pltdoc="x">Lecture 33</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l34.html" class="tocviewlink" data-pltdoc="x">Lecture 34</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l35.html" class="tocviewlink" data-pltdoc="x">Lecture 35:<span class="mywbr"> &nbsp;</span> Exam 2, Part A</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l36.html" class="tocviewlink" data-pltdoc="x">Lecture 36:<span class="mywbr"> &nbsp;</span> Exam 2, Part B</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l37.html" class="tocviewlink" data-pltdoc="x">Lecture 37</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="l38.html" class="tocviewlink" data-pltdoc="x">Lecture 38</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">►</a>
        </td>
        <td></td>
        <td>
         <a href="" class="tocviewselflink" data-pltdoc="x">Lecture 28:<span class="mywbr"> &nbsp;</span> Induction</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublistbottom" style="display: none;" id="tocview_2">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right">
          1&nbsp;
         </td>
         <td>
          <a href="#%28part._.Purpose%29" class="tocviewlink" data-pltdoc="x">Purpose</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          2&nbsp;
         </td>
         <td>
          <a href="#%28part._.Outline%29" class="tocviewlink" data-pltdoc="x">Outline</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          3&nbsp;
         </td>
         <td>
          <a href="#%28part._.Induction_tactic__in_more_detail%29" class="tocviewlink" data-pltdoc="x">Induction tactic, in more detail</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          4&nbsp;
         </td>
         <td>
          <a href="#%28part._.Induction_via_recursion%29" class="tocviewlink" data-pltdoc="x">Induction via recursion</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="tocsub">
    <div class="tocsubtitle">
     On this page:
    </div>
    <table class="tocsublist" cellspacing="0">
     <tbody>
      <tr>
       <td>
        <span class="tocsublinknumber">1
        <tt>
         &nbsp;
        </tt>
       </span>
       <a href="#%28part._.Purpose%29" class="tocsubseclink" data-pltdoc="x">Purpose</a>
      </td>
     </tr>
     <tr>
      <td>
       <span class="tocsublinknumber">2
       <tt>
        &nbsp;
       </tt>
      </span>
      <a href="#%28part._.Outline%29" class="tocsubseclink" data-pltdoc="x">Outline</a>
     </td>
    </tr>
    <tr>
     <td>
      <span class="tocsublinknumber">3
      <tt>
       &nbsp;
      </tt>
     </span>
     <a href="#%28part._.Induction_tactic__in_more_detail%29" class="tocsubseclink" data-pltdoc="x">Induction tactic, in more detail</a>
    </td>
   </tr>
   <tr>
    <td>
     <span class="tocsublinknumber">4
     <tt>
      &nbsp;
     </tt>
    </span>
    <a href="#%28part._.Induction_via_recursion%29" class="tocsubseclink" data-pltdoc="x">Induction via recursion</a>
   </td>
  </tr>
 </tbody>
</table>
</div>
</div>
<div class="maincolumn">
<div class="main">
<div class="versionbox">
 <span class="version">8.7</span>
</div>
<div class="navsettop">
 <span class="navleft">
 <div class="nosearchform"></div>
 &nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="l27.html" title="backward to &quot;Lecture 27: Compiler Correctness&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="l29.html" title="forward to &quot;Lecture 29: Functions vs. Relations&quot;" data-pltdoc="x">next →</a></span>&nbsp;
</div>
<h4>
<a name="(part._l28)"></a>Lecture 28: Induction
</h4>
<h5>
1
<tt>
 &nbsp;
</tt>
<a name="(part._.Purpose)"></a>Purpose
</h5>
<p>
A deep dive on induction.
</p>
<h5>
2
<tt>
 &nbsp;
</tt>
<a name="(part._.Outline)"></a>Outline
</h5>
<p>
At this point, you have done a lot of proofs by induction, all using the induction tactic. The intuition we’ve been using is that induction is like case analysis, except that for each constructor that has recursive data, you end up with an induction hypothesis for that subpart of the data.
</p>
<p>
Today, we will look much more closely on where induction gets that from, and an alternate way to do inductive proofs.
</p>
<h5>
3
<tt>
 &nbsp;
</tt>
<a name="(part._.Induction_tactic__in_more_detail)"></a>Induction tactic, in more detail
</h5>
<p>
When we have a proof like:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">theorem</span> <span class="n">φ</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">Nat.add</span> <span class="mi">0</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="n">intros</span> <span class="n">n</span>
    <span class="n">induction</span> <span class="n">n</span>
    <span class="n">case</span> <span class="n">zero</span> <span class="bp">=&gt;</span> <span class="n">rfl</span>
    <span class="n">case</span> <span class="n">succ</span> <span class="n">n</span> <span class="n">IH</span> <span class="bp">=&gt;</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">Nat.add</span><span class="o">]</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">IH</span><span class="o">]</span>
</pre>
</div>
</div>
<p>
If we were to prove this, on paper, one way would be to prove:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="n">φ</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>

<span class="n">n</span><span class="o">:</span> <span class="n">φ</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="n">φ</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>

<span class="n">t</span>

<span class="n">φ</span><span class="o">(</span><span class="n">t</span><span class="o">)</span>
</pre>
</div>
</div>
<p>
e.g., to get ϕ(4), we can use the second case to conclude this if we can show
ϕ(3), which we can conclude if we can show
ϕ(2), which we can conclude if we can show
ϕ(1), which we can conclude if we can show
ϕ(0), which is the first case.
</p>
<p>
This corresponds directly to how induction works, and in particular, how the induction tactic works.
</p>
<p>
If we look carefull at the tactic state right before we run induction n, we see:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span>
<span class="bp">⊢</span> <span class="n">Nat.add</span> <span class="mi">0</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span>
</pre>
</div>
</div>
<p>
First, note that we always apply <span class="default"><code class="highlight-inline"><span class="n">induction</span></code></span> to a variable that is in the context. While informally we might say that we proceed "by natural number induction", formally, while we are using the natural number induction principle, we are particularly applying it to a given natural number. Why does that matter? And where, exactly, do the obligations come from? Informally, we’ve said that "induction is like case analysis with extra hypotheses for the recursive cases". Formally, every inductive type has what is called a "recursor"; we can print it out with, e.g.,
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="k">#print</span> <span class="n">Nat.rec</span>
</pre>
</div>
</div>
<p>
This prints:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span>    <span class="n">recursor</span> <span class="n">Nat.rec.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="o">{</span><span class="n">motive</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Sort</span> <span class="n">u</span><span class="o">}</span> <span class="bp">→</span>
<span class="n">motive</span> <span class="n">Nat.zero</span> <span class="bp">→</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="n">motive</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">motive</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">))</span> <span class="bp">→</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="n">motive</span> <span class="n">t</span>
</pre>
</div>
</div>
<p>
Recursors are primitive aspects of inductive types, so the implementation is just called <span class="default"><code class="highlight-inline"><span class="n">recursor</span> <span class="n">Nat.rec.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span></code></span>, but the type is quite informative. It is a lot to read at first, but if we reformat it slightly, and add comments:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="n">recursor</span> <span class="n">Nat.rec.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">:</span>
<span class="o">{</span><span class="n">motive</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Sort</span> <span class="n">u</span><span class="o">}</span> <span class="bp">→</span> <span class="c1">-- what we are trying to prove</span>
<span class="n">motive</span> <span class="n">Nat.zero</span> <span class="bp">→</span>         <span class="c1">-- proof for Nat.zero case</span>
<span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="n">motive</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">motive</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">))</span> <span class="bp">→</span> <span class="c1">-- proof for Nat.succ case</span>
<span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="c1">-- the number we want the proof for</span>
<span class="n">motive</span> <span class="n">t</span> <span class="c1">-- the proof for that number</span>
</pre>
</div>
</div>
<p>
The key (and also most confusing at first) part of this is the <span class="default"><code class="highlight-inline"><span class="n">motive</span></code></span> argument. This is a function that takes a natural number and returns... essentially anything. For proofs, it will usually return <span class="default"><code class="highlight-inline"><span class="kt">Prop</span></code></span>. It’s fine to read <span class="default"><code class="highlight-inline"><span class="kt">Sort</span> <span class="n">u</span></code></span> as <span class="default"><code class="highlight-inline"><span class="kt">Prop</span></code></span> for now. What is an example of a <span class="default"><code class="highlight-inline"><span class="n">motive</span></code></span>?
</p>
<p>
Well, if we look at the proof we just did,
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">Nat.add</span> <span class="mi">0</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span>
</pre>
</div>
</div>
<p>
Would be something of type <span class="default"><code class="highlight-inline"><span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Prop</span></code></span>, and in particular, it would be our motive. The first thing the induction tactic does is take the goal and turn it into a motive by replacing what we are doing induction on with a forall. This is why if we change the goal (make it more general, most likely) before we do induction, the motive that ends up being used will change, which may make the proof easier. The state of goal at the time we do induction is what determines the motive.
</p>
<p>
Once we have the motive, we have to prove cases for each of the constructors. These are derived from the definition of the inductive type. In particular, arguments for constructors will be passed in, but for arguments that are themselves instances of the type (self-referential arguments, in other words), we also get the motive applied to that argument. This is why in the successor case, to prove that motive <span class="default"><code class="highlight-inline"><span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span></code></span>, we get as an argument that <span class="default"><code class="highlight-inline"><span class="n">motive</span> <span class="n">n</span></code></span> as well as just <span class="default"><code class="highlight-inline"><span class="n">n</span></code></span>.
</p>
<p>
But note, in contrast, that if we defined a <span class="default"><code class="highlight-inline"><span class="n">NatList</span></code></span> as:
</p>
<p></p>
<div class="SIntrapara">
<div class="default">
 <div class="highlight">
  <pre><span></span>    <span class="kd">inductive</span> <span class="n">NatList</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">NatList</span>
<span class="bp">|</span> <span class="n">cons</span> <span class="o">(</span><span class="n">first</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">rest</span> <span class="o">:</span> <span class="n">NatList</span><span class="o">)</span> <span class="o">:</span> <span class="n">NatList</span>
</pre>
 </div>
</div>
</div>
<div class="SIntrapara">
Then the recursor would be:
</div>
<p></p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="n">recursor</span> <span class="n">NatList.rec.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">:</span>
<span class="o">{</span><span class="n">motive</span> <span class="o">:</span> <span class="n">NatList</span> <span class="bp">→</span> <span class="kt">Sort</span> <span class="n">u</span><span class="o">}</span> <span class="bp">→</span>
<span class="n">motive</span> <span class="n">NatList.nil</span> <span class="bp">→</span>
<span class="o">((</span><span class="n">first</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">rest</span> <span class="o">:</span> <span class="n">NatList</span><span class="o">)</span> <span class="bp">→</span> <span class="n">motive</span> <span class="n">rest</span> <span class="bp">→</span> <span class="n">motive</span> <span class="o">(</span><span class="n">NatList.cons</span> <span class="n">first</span> <span class="n">rest</span><span class="o">))</span> <span class="bp">→</span>
<span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">NatList</span><span class="o">)</span> <span class="bp">→</span>
<span class="n">motive</span> <span class="n">t</span>
</pre>
</div>
</div>
<p>
In this, for the <span class="default"><code class="highlight-inline"><span class="n">cons</span></code></span> case, the <span class="default"><code class="highlight-inline"><span class="n">rest</span></code></span> argument has the <span class="default"><code class="highlight-inline"><span class="n">motive</span></code></span> applied to it, but not the <span class="default"><code class="highlight-inline"><span class="n">first</span></code></span> argument, since the first argument is a <span class="default"><code class="highlight-inline"><span class="n">Nat</span></code></span>, so its not self-referential.
</p>
<p>
Once we provide all of those arguments (which amounts to proving each case), we just have to provide an element of the data type (this is the argument we were doing induction on), and we get back the <span class="default"><code class="highlight-inline"><span class="n">motive</span></code></span> applied to that argument, which based on how the <span class="default"><code class="highlight-inline"><span class="n">motive</span></code></span> was originally constructed, is enough to complete the proof.
</p>
<p>
This is, more or less, just more detail about a process that at this point should be quite familiar. But today we are going to go a bit beyond it.
</p>
<h5>
4
<tt>
 &nbsp;
</tt>
<a name="(part._.Induction_via_recursion)"></a>Induction via recursion
</h5>
<p>
If you remember, we had one example where invoking the induction tactic didn’t seem to work at all.
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">inductive</span> <span class="n">ev</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="n">where</span>
  <span class="bp">|</span> <span class="n">O</span> <span class="o">:</span> <span class="n">ev</span> <span class="mi">0</span>
  <span class="bp">|</span> <span class="n">SS</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">ev</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">ev</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">))</span>

<span class="kd">def</span> <span class="n">even</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">Bool</span>
  <span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="n">true</span>
  <span class="bp">|</span> <span class="mi">1</span> <span class="bp">=&gt;</span> <span class="n">false</span>
  <span class="bp">|</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">even</span> <span class="n">n</span>

<span class="kd">example</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">even</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">true</span> <span class="bp">-&gt;</span> <span class="n">ev</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="n">intros</span> <span class="n">n</span> <span class="n">H</span>
     <span class="n">induction</span> <span class="n">n</span>
     <span class="n">case</span> <span class="n">zero</span> <span class="bp">=&gt;</span> <span class="n">constructor</span>
     <span class="n">case</span> <span class="n">succ</span> <span class="n">n</span> <span class="n">IH</span> <span class="bp">=&gt;</span> <span class="gr">sorry</span>
</pre>
</div>
</div>
<p>
The problem was that the structure of natural number induction didn’t seem to match up: evenness goes up every two numbers, not every one, so the <span class="default"><code class="highlight-inline"><span class="n">Nat.succ</span></code></span> case of <span class="default"><code class="highlight-inline"><span class="n">Nat.rec</span></code></span> doesn’t seem feasible.
</p>
<p>
Now, while recursors are fundamental (and used not only by induction, but by recursive functions as well), the semi-naive way that they are invoked by induction is not the only way that we can use them. In particular, if we use them more directly by writing recursive functions (which are compiled to calls to the recursors), we can get more control over how the induction is done.
</p>
<p>
We did this in the example for evenness:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">def</span> <span class="n">even_ev</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">even</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">true</span> <span class="bp">-&gt;</span> <span class="n">ev</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="k">fun</span> <span class="n">_</span> <span class="bp">=&gt;</span> <span class="n">ev.O</span>
<span class="bp">|</span> <span class="mi">1</span> <span class="bp">=&gt;</span> <span class="k">fun</span> <span class="n">H</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">contradiction</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="k">fun</span> <span class="n">H</span> <span class="bp">=&gt;</span> <span class="n">ev.SS</span> <span class="n">n</span> <span class="o">(</span><span class="n">even_ev</span> <span class="n">n</span> <span class="n">H</span><span class="o">)</span>
</pre>
</div>
</div>
<p>
Of course, we can write this in a bit more tactic-style: still using pattern matching to structure the recursion to be every two, and critically, handling the recursive case by a recursive call to the function (which will get translated to a call to the recursor).
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">theorem</span> <span class="n">even_ev'</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">even</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">true</span> <span class="bp">-&gt;</span> <span class="n">ev</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">constructor</span>
<span class="bp">|</span> <span class="mi">1</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">contradiction</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">=&gt;</span> 
  <span class="kd">by</span> <span class="n">intros</span> <span class="n">H</span><span class="bp">;</span> <span class="n">constructor</span><span class="bp">;</span> <span class="n">exact</span> <span class="o">(</span><span class="n">even_ev'</span> <span class="n">n</span> <span class="n">H</span><span class="o">)</span>
</pre>
</div>
</div>
<p>
You might be tempted to write all inductive proofs like this: indeed, if you are careful, you certainly can. For example, here’s another theorem we did, rewritten that way:
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">def</span> <span class="n">double</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="n">Nat</span> 
    <span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="mi">0</span>
    <span class="bp">|</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="o">(</span><span class="n">double</span> <span class="n">x</span><span class="o">))</span>

<span class="kd">theorem</span> <span class="n">even_double</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">,</span> <span class="n">even</span> <span class="o">(</span><span class="n">double</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">true</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">rfl</span> 
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">even</span><span class="o">,</span> <span class="n">double</span><span class="o">]</span><span class="bp">;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">even_double</span> <span class="n">n</span><span class="o">]</span> 
</pre>
</div>
</div>
<p>
But one risk with this, is you might end up trying to make recursive calls to the theorem that don’t satisfy the termination checker (satisfying the terminatior checker is actually a matter of writing things in such a way that the recursive calls can be turned into invocations of the recursor!). The nice thing about the induction tactic is that it only gives you as hypotheses things that you certainly can use to prove the goal. Recursion is a little trickier; it gives more flexibility, but some recursive patterns that seem okay may actually not be!
</p>
<p>
As an exercise, let’s rewrite the two proofs about addtail from HW7 using induction via recursion instead of the induction tactic.
</p>
<p></p>
<div class="SIntrapara">
<div class="default">
 <div class="highlight">
  <pre><span></span><span class="kn">namespace</span> <span class="n">HW7</span>

<span class="kd">def</span> <span class="n">Nat.add</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="n">Nat</span>
  <span class="bp">|</span> <span class="n">Nat.zero</span><span class="o">,</span> <span class="n">b</span>   <span class="bp">=&gt;</span> <span class="n">b</span>
  <span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">a</span><span class="o">,</span> <span class="n">b</span> <span class="bp">=&gt;</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.add</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">addtail</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">Nat</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">n</span><span class="o">,</span> <span class="n">m</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="n">Nat.zero</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span> <span class="n">m</span>
  <span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">n'</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span> <span class="n">addtail</span> <span class="n">n'</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">m</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">addtail_succ</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">addtail</span> <span class="n">n</span> <span class="n">m</span><span class="o">)</span> <span class="bp">=</span> <span class="n">addtail</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">)</span> <span class="n">m</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">addtail</span><span class="o">]</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">n</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span> 
   <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">addtail</span><span class="o">]</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">addtail_succ</span> <span class="n">n</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">m</span><span class="o">)]</span>
      <span class="n">rfl</span> 

<span class="kd">theorem</span> <span class="n">add_eq</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span> <span class="n">Nat.add</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">addtail</span> <span class="n">n</span> <span class="n">m</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">Nat.add</span><span class="o">,</span> <span class="n">addtail</span><span class="o">]</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">n</span><span class="o">,</span> <span class="n">m</span> <span class="bp">=&gt;</span>
   <span class="kd">by</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">Nat.add</span><span class="o">]</span>
      <span class="n">rw</span> <span class="o">[</span><span class="n">add_eq</span> <span class="n">n</span> <span class="n">m</span><span class="o">]</span>
      <span class="n">apply</span> <span class="n">addtail_succ</span>

<span class="kd">end</span> <span class="n">HW7</span>
</pre>
 </div>
</div>
</div>
<div class="SIntrapara">
As another exercise, let’s consider proving that an equality function on natural numbers is symmetric:
</div>
<div class="SIntrapara">
<div class="default">
 <div class="highlight">
  <pre><span></span><span class="kd">def</span> <span class="n">eqb</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="n">Bool</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="n">true</span> 
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="n">Nat.succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> <span class="n">false</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="n">false</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">x</span><span class="o">,</span> <span class="n">Nat.succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> <span class="n">eqb</span> <span class="n">x</span> <span class="n">y</span> 

<span class="kd">theorem</span> <span class="n">eqb_sym</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">,</span> <span class="n">eqb</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">eqb</span> <span class="n">y</span> <span class="n">x</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="n">intros</span> <span class="n">x</span>
    <span class="n">induction</span> <span class="n">x</span> <span class="bp">&lt;;&gt;</span> <span class="n">intros</span> <span class="n">y</span>
    <span class="n">case</span> <span class="n">zero</span> <span class="bp">=&gt;</span> <span class="n">cases</span> <span class="n">y</span> <span class="bp">&lt;;&gt;</span> <span class="n">rfl</span>
    <span class="n">case</span> <span class="n">succ</span> <span class="n">x</span> <span class="n">IH</span> <span class="bp">=&gt;</span> 
      <span class="n">cases</span> <span class="n">y</span> <span class="bp">&lt;;&gt;</span> <span class="n">try</span> <span class="n">rfl</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">eqb</span><span class="o">]</span>

<span class="kd">theorem</span> <span class="n">eqb_sym'</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">,</span> <span class="n">eqb</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">eqb</span> <span class="n">y</span> <span class="n">x</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="n">Nat.succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">x</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="kd">by</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">x</span><span class="o">,</span> <span class="n">Nat.succ</span> <span class="n">y</span> <span class="bp">=&gt;</span> 
  <span class="kd">by</span> <span class="k">have</span> <span class="n">IH</span> <span class="o">:</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">eqb_sym'</span> <span class="n">x</span> <span class="n">y</span>
     <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">eqb</span><span class="o">]</span>
</pre>
 </div>
</div>
</div>
<p></p>
<div class="navsetbottom">
<span class="navleft">
<div class="nosearchform"></div>
&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="l27.html" title="backward to &quot;Lecture 27: Compiler Correctness&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="l29.html" title="forward to &quot;Lecture 29: Functions vs. Relations&quot;" data-pltdoc="x">next →</a></span>&nbsp;
</div>
</div>
</div>
<div id="contextindicator">
&nbsp;
</div>
</body>
</html>
