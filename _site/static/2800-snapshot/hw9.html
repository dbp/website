<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.8">
  <title>
   dbp.io
  </title>
  <link rel="stylesheet" type="text/css" href="scribble.css" title="default">
  <link rel="stylesheet" type="text/css" href="minted.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-style.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-racket.css" title="default">
  <link rel="stylesheet" type="text/css" href="minted-default-style.css" title="default">
  <link rel="stylesheet" type="text/css" href="main.css" title="default">
  <script type="text/javascript" src="scribble-common.js"></script>
  <script type="text/javascript" src="manual-racket.js"></script>
 </head>
 <body id="scribble-racket-lang-org">
  <div class="tocset">
   <div class="tocview">
    <div class="tocviewlist tocviewlisttopspace">
     <div class="tocviewtitle">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td style="width: 1em;">
          <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a>
         </td>
         <td></td>
         <td>
          <a href="index.html" class="tocviewlink" data-pltdoc="x">Logic &amp; Computation</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
     <div class="tocviewsublisttop" style="display: none;" id="tocview_0">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="schedule.html" class="tocviewlink" data-pltdoc="x">Schedule</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lectures.html" class="tocviewlink" data-pltdoc="x">Lectures</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="homework.html" class="tocviewselflink" data-pltdoc="x">Homework</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="ref.html" class="tocviewlink" data-pltdoc="x">Lean Tactic Reference</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a>
        </td>
        <td></td>
        <td>
         <a href="homework.html" class="tocviewlink" data-pltdoc="x">Homework</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublist" style="display: block;" id="tocview_1">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right">
          1&nbsp;
         </td>
         <td>
          <a href="hw1.html" class="tocviewlink" data-pltdoc="x">Homework 1</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          2&nbsp;
         </td>
         <td>
          <a href="hw2.html" class="tocviewlink" data-pltdoc="x">Homework 2</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          3&nbsp;
         </td>
         <td>
          <a href="hw3.html" class="tocviewlink" data-pltdoc="x">Homework 3</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          4&nbsp;
         </td>
         <td>
          <a href="hw4.html" class="tocviewlink" data-pltdoc="x">Homework 4</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          5&nbsp;
         </td>
         <td>
          <a href="hw5.html" class="tocviewlink" data-pltdoc="x">Homework 5</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          6&nbsp;
         </td>
         <td>
          <a href="hw7.html" class="tocviewlink" data-pltdoc="x">Homework 7</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          7&nbsp;
         </td>
         <td>
          <a href="" class="tocviewselflink" data-pltdoc="x">Homework 9</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          8&nbsp;
         </td>
         <td>
          <a href="hw10.html" class="tocviewlink" data-pltdoc="x">Homework 10</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          9&nbsp;
         </td>
         <td>
          <a href="hw11.html" class="tocviewlink" data-pltdoc="x">Homework 11</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          10&nbsp;
         </td>
         <td>
          <a href="hw12.html" class="tocviewlink" data-pltdoc="x">Homework 12</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">►</a>
        </td>
        <td>
         7&nbsp;
        </td>
        <td>
         <a href="" class="tocviewselflink" data-pltdoc="x">Homework 9</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublistbottom" style="display: none;" id="tocview_2">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right">
          7.1&nbsp;
         </td>
         <td>
          <a href="#%28part._.Problem_1__.Append_and_.Reverse%29" class="tocviewlink" data-pltdoc="x">Problem 1:<span class="mywbr"> &nbsp;</span> Append and Reverse</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          7.2&nbsp;
         </td>
         <td>
          <a href="#%28part._.Problem_2__.Evenness__and_.Relations_%29" class="tocviewlink" data-pltdoc="x">Problem 2:<span class="mywbr"> &nbsp;</span> Evenness (and Relations)</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          7.3&nbsp;
         </td>
         <td>
          <a href="#%28part._.Problem_3__.Subsequences%29" class="tocviewlink" data-pltdoc="x">Problem 3:<span class="mywbr"> &nbsp;</span> Subsequences</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          7.4&nbsp;
         </td>
         <td>
          <a href="#%28part._.Problem_4__.Insertion_.Sort%29" class="tocviewlink" data-pltdoc="x">Problem 4:<span class="mywbr"> &nbsp;</span> Insertion Sort</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="tocsub">
    <div class="tocsubtitle">
     On this page:
    </div>
    <table class="tocsublist" cellspacing="0">
     <tbody>
      <tr>
       <td>
        <span class="tocsublinknumber">7.1
        <tt>
         &nbsp;
        </tt>
       </span>
       <a href="#%28part._.Problem_1__.Append_and_.Reverse%29" class="tocsubseclink" data-pltdoc="x">Problem 1:<span class="mywbr"> &nbsp;</span> Append and Reverse</a>
      </td>
     </tr>
     <tr>
      <td>
       <span class="tocsublinknumber">7.2
       <tt>
        &nbsp;
       </tt>
      </span>
      <a href="#%28part._.Problem_2__.Evenness__and_.Relations_%29" class="tocsubseclink" data-pltdoc="x">Problem 2:<span class="mywbr"> &nbsp;</span> Evenness (and Relations)</a>
     </td>
    </tr>
    <tr>
     <td>
      <span class="tocsublinknumber">7.3
      <tt>
       &nbsp;
      </tt>
     </span>
     <a href="#%28part._.Problem_3__.Subsequences%29" class="tocsubseclink" data-pltdoc="x">Problem 3:<span class="mywbr"> &nbsp;</span> Subsequences</a>
    </td>
   </tr>
   <tr>
    <td>
     <span class="tocsublinknumber">7.4
     <tt>
      &nbsp;
     </tt>
    </span>
    <a href="#%28part._.Problem_4__.Insertion_.Sort%29" class="tocsubseclink" data-pltdoc="x">Problem 4:<span class="mywbr"> &nbsp;</span> Insertion Sort</a>
   </td>
  </tr>
 </tbody>
</table>
</div>
</div>
<div class="maincolumn">
<div class="main">
<div class="versionbox">
 <span class="version">8.7</span>
</div>
<div class="navsettop">
 <span class="navleft">
 <div class="nosearchform"></div>
 &nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="hw7.html" title="backward to &quot;6 Homework 7&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="hw10.html" title="forward to &quot;8 Homework 10&quot;" data-pltdoc="x">next →</a></span>&nbsp;
</div>
<h4>
7
<tt>
 &nbsp;
</tt>
<a name="(part._hw9)"></a>Homework 9
</h4>
<p>
<span style="font-weight: bold">Released:</span> <span style="font-style: italic">Monday, March 13, 2023 at 6:00pm</span>
</p>
<p>
<span style="font-weight: bold">Due:</span> <span style="font-style: italic">Wednesday, March 22, 2023 at 6:00pm</span>
</p>
<blockquote class="boxed">
<p>
 What to Download:
</p>
<p>
 <a href="https://github.com/logiccomp/s23-hw9/raw/main/hw9.lean"><span class="url">https://github.com/logiccomp/s23-hw9/raw/main/hw9.lean</span></a>
</p>
</blockquote>
<p>
Please start with this file, filling in where appropriate, and submit your homework to the <span class="stt">hw9</span> assignment on Gradescope. This page has additional information, and allows us to format things nicely.
</p>
<p>
<span style="font-weight: bold">To do this assignment in the browser: <a href="https://github.com/codespaces/new?machine=basicLinux32gb&amp;repo=578247746&amp;location=EastUs&amp;ref=main&amp;devcontainer_path=.devcontainer%2Fdevcontainer.json">Create a Codespace</a>.</span>
</p>
<p>
In this homework assignment, you will get significantly more practice doing more challenging proofs in Lean.
</p>
<p>
As before, we provide line counts for how long our reference solutions are: these are not the only ways to do the proofs (and you will not be penalized if you proofs take longer), and lines are a poor metric of complexity (as you can easily make things more compact or spread out), but are intended as a tool to help you not go too far down a path that isn’t working. For example, if we had a proof that took 20 lines, and you are 100 lines into an attempt and it isn’t working, it might be an indication that you made a decision (choice of what to do induction on, etc) that isn’t working.
</p>
<h5>
7.1
<tt>
 &nbsp;
</tt>
<a name="(part._.Problem_1__.Append_and_.Reverse)"></a>Problem 1: Append and Reverse
</h5>
<p>
First, a few proofs about append and reverse. For this assignment, we are using the standard library data structures, but here we define our own definition of append (called <span class="default"><code class="highlight-inline"><span class="n">app</span></code></span>), instead of <span class="default"><code class="highlight-inline"><span class="n">List.append</span></code></span>, and our own reverse (called <span class="default"><code class="highlight-inline"><span class="n">rev</span></code></span>) instead of <span class="default"><code class="highlight-inline"><span class="n">List.reverse</span></code></span>.
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">def</span> <span class="n">app</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span>
  <span class="bp">|</span> <span class="n">List.nil</span><span class="o">,</span>       <span class="n">bs</span> <span class="bp">=&gt;</span> <span class="n">bs</span>
  <span class="bp">|</span> <span class="n">List.cons</span> <span class="n">a</span> <span class="n">as</span><span class="o">,</span> <span class="n">bs</span> <span class="bp">=&gt;</span> <span class="n">List.cons</span> <span class="n">a</span> <span class="o">(</span><span class="n">app</span> <span class="n">as</span> <span class="n">bs</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">rev</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span> 
  <span class="bp">|</span> <span class="n">List.nil</span> <span class="bp">=&gt;</span> <span class="n">List.nil</span>
  <span class="bp">|</span> <span class="n">List.cons</span> <span class="n">a</span> <span class="n">L</span> <span class="bp">=&gt;</span> <span class="n">app</span> <span class="o">(</span><span class="n">rev</span> <span class="n">L</span><span class="o">)</span> <span class="o">(</span><span class="n">List.cons</span> <span class="n">a</span> <span class="n">List.nil</span><span class="o">)</span> 

<span class="c1">-- 6 lines</span>
<span class="kd">theorem</span> <span class="n">app_nil</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">),</span> <span class="n">app</span> <span class="n">l</span> <span class="o">[]</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">:=</span> 
  <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 6 lines</span>
<span class="kd">theorem</span> <span class="n">app_assoc</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="n">l3</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">),</span>
  <span class="n">app</span> <span class="o">(</span><span class="n">app</span> <span class="n">l1</span> <span class="n">l2</span><span class="o">)</span> <span class="n">l3</span> <span class="bp">=</span> <span class="n">app</span> <span class="n">l1</span> <span class="o">(</span><span class="n">app</span> <span class="n">l2</span> <span class="n">l3</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 8 lines</span>
<span class="kd">theorem</span> <span class="n">rev_app_distr</span><span class="o">:</span> <span class="k">forall</span> <span class="n">l1</span> <span class="n">l2</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">,</span>
  <span class="n">rev</span> <span class="o">(</span><span class="n">app</span> <span class="n">l1</span> <span class="n">l2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">app</span> <span class="o">(</span><span class="n">rev</span> <span class="n">l2</span><span class="o">)</span> <span class="o">(</span><span class="n">rev</span> <span class="n">l1</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 8 lines</span>
<span class="kd">theorem</span> <span class="n">rev_involutive</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">,</span>
  <span class="n">rev</span> <span class="o">(</span><span class="n">rev</span> <span class="n">l</span><span class="o">)</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>
</pre>
</div>
</div>
<h5>
7.2
<tt>
 &nbsp;
</tt>
<a name="(part._.Problem_2__.Evenness__and_.Relations_)"></a>Problem 2: Evenness (and Relations)
</h5>
<p>
In this problem, you will practice more with expressing properties using relations (rather than boolean predicates). Here we have two different definitions of evenness (one of which you have seen in lecture before), and among other proofs, you will prove that the two are equivalent.
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">inductive</span> <span class="n">ev</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span> 
<span class="bp">|</span> <span class="n">O</span> <span class="o">:</span> <span class="n">ev</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">SS</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">ev</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">ev</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="n">n</span><span class="o">))</span>

<span class="kd">def</span> <span class="n">double</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">Nat</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">Nat.succ</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="n">Nat.succ</span> <span class="o">(</span><span class="n">Nat.succ</span> <span class="o">(</span><span class="n">double</span> <span class="n">n</span><span class="o">))</span>

<span class="c1">-- 5 lines</span>
<span class="kd">theorem</span> <span class="n">ev_double</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">ev</span> <span class="o">(</span><span class="n">double</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 15 lines</span>
<span class="kd">theorem</span> <span class="n">ev_sum</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span> <span class="n">ev</span> <span class="n">n</span> <span class="bp">-&gt;</span> <span class="n">ev</span> <span class="n">m</span> <span class="bp">-&gt;</span> <span class="n">ev</span> <span class="o">(</span><span class="n">Nat.add</span> <span class="n">n</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 3 lines</span>
<span class="kd">theorem</span> <span class="n">three_not_ev</span> <span class="o">:</span> <span class="n">Not</span> <span class="o">(</span><span class="n">ev</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="kd">inductive</span> <span class="n">ev'</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span> <span class="o">:=</span>
  <span class="bp">|</span> <span class="n">O</span> <span class="o">:</span> <span class="n">ev'</span> <span class="mi">0</span>
  <span class="bp">|</span> <span class="n">SSO</span> <span class="o">:</span> <span class="n">ev'</span> <span class="mi">2</span>
  <span class="bp">|</span> <span class="n">sum</span> <span class="n">n</span> <span class="n">m</span> <span class="o">(</span><span class="n">Hn</span> <span class="o">:</span> <span class="n">ev'</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">Hm</span> <span class="o">:</span> <span class="n">ev'</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">ev'</span> <span class="o">(</span><span class="n">Nat.add</span> <span class="n">n</span> <span class="n">m</span><span class="o">)</span>

<span class="c1">-- 21 lines</span>
<span class="kd">theorem</span> <span class="n">ev'_ev</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="n">ev'</span> <span class="n">n</span> <span class="bp">&lt;-&gt;</span> <span class="n">ev</span> <span class="n">n</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>
</pre>
</div>
</div>
<h5>
7.3
<tt>
 &nbsp;
</tt>
<a name="(part._.Problem_3__.Subsequences)"></a>Problem 3: Subsequences
</h5>
<p>
In this problem, you will see a new relation, expressing when one list of natural numbers is a subsequence of another. To practice dealing with the relation (and understand how it works), you will prove a few properties about it.
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">inductive</span> <span class="n">subseq</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">empty</span> <span class="o">:</span> <span class="n">subseq</span> <span class="o">[]</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="kn">include</span> <span class="n">x</span> <span class="n">l1</span> <span class="n">l2</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">subseq</span> <span class="n">l1</span> <span class="n">l2</span><span class="o">)</span> <span class="o">:</span> <span class="n">subseq</span> <span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">skip</span> <span class="n">x</span> <span class="n">l1</span> <span class="n">l2</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">subseq</span> <span class="n">l1</span> <span class="n">l2</span><span class="o">)</span> <span class="o">:</span> <span class="n">subseq</span> <span class="n">l1</span> <span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">)</span>

<span class="c1">-- 6 lines</span>
<span class="kd">theorem</span> <span class="n">subseq_refl</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">),</span> 
  <span class="n">subseq</span> <span class="n">l</span> <span class="n">l</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 5 lines</span>
<span class="kd">theorem</span> <span class="n">subseq_empty</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">l</span><span class="o">,</span> <span class="n">subseq</span> <span class="o">[]</span> <span class="n">l</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 13 lines</span>
<span class="kd">theorem</span> <span class="n">subseq_app</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="n">l3</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span><span class="o">),</span>
  <span class="n">subseq</span> <span class="n">l1</span> <span class="n">l2</span> <span class="bp">-&gt;</span>
  <span class="n">subseq</span> <span class="n">l1</span> <span class="o">(</span><span class="n">List.append</span> <span class="n">l2</span> <span class="n">l3</span><span class="o">)</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>
</pre>
</div>
</div>
<h5>
7.4
<tt>
 &nbsp;
</tt>
<a name="(part._.Problem_4__.Insertion_.Sort)"></a>Problem 4: Insertion Sort
</h5>
<p>
In this problem, you will prove insertion sort is correct. This will be done in several steps, first by proving various properties about the <span class="default"><code class="highlight-inline"><span class="n">insert</span></code></span> function, which you will then be able to use to prove the same properties about <span class="default"><code class="highlight-inline"><span class="n">isort</span></code></span>.
</p>
<p>
There are two halves of the problem: first, to prove that <span class="default"><code class="highlight-inline"><span class="n">isort</span></code></span> (and <span class="default"><code class="highlight-inline"><span class="n">insert</span></code></span>) produces <span style="font-style: italic">sorted</span> lists, where we have a relation that defines what it means to be sorted. This relation uses another relation, <span class="default"><code class="highlight-inline"><span class="n">All</span></code></span>, as a helper: <span class="default"><code class="highlight-inline"><span class="n">All</span></code></span> is a relation that holds when a property holds for all elements of a list, in this case, we use it to show that the front of a sorted list is less or equal to all other elements of the list.
</p>
<p>
The other half of the problem is to ensure that <span class="default"><code class="highlight-inline"><span class="n">isort</span></code></span> (and <span class="default"><code class="highlight-inline"><span class="n">insert</span></code></span>) produce <span style="font-style: italic">permutations</span> of the input lists. This relies upon a new definition of <span style="font-style: italic">permutation</span>, which is a relation that holds when two lists have the same elements, but possibly in a different order. To practice with this definition (which is similar to the subsequence definition from Problem 3), we have a few theorems for you to prove, before proving the main results.
</p>
<p>
We provide a few helper theorems that you may use in your proofs (we did in ours). In general, defining helper theorems is a good idea, as it can help you break down a problem into smaller pieces.
</p>
<p>
<span style="font-weight: bold">Note: the proofs for the insert functions are where most of the work is!</span>
</p>
<div class="default">
<div class="highlight">
 <pre><span></span><span class="kd">def</span> <span class="n">insert</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span>
<span class="bp">|</span> <span class="n">y</span><span class="o">,</span> <span class="o">[]</span> <span class="bp">=&gt;</span> <span class="o">[</span><span class="n">y</span><span class="o">]</span>
<span class="bp">|</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span><span class="o">::</span><span class="n">xs</span> <span class="bp">=&gt;</span> <span class="k">if</span> <span class="n">Nat.ble</span> <span class="n">y</span> <span class="n">x</span> 
              <span class="k">then</span> <span class="n">y</span> <span class="o">::</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> 
              <span class="k">else</span> <span class="n">x</span> <span class="o">::</span> <span class="n">insert</span> <span class="n">y</span> <span class="n">xs</span>

<span class="kd">def</span> <span class="n">isort</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">Nat</span>
<span class="bp">|</span> <span class="o">[]</span>      <span class="bp">=&gt;</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="bp">=&gt;</span> <span class="n">insert</span> <span class="n">x</span> <span class="o">(</span><span class="n">isort</span> <span class="n">xs</span><span class="o">)</span> 

<span class="kd">inductive</span> <span class="n">All</span> <span class="o">:</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="bp">-&gt;</span> <span class="o">(</span><span class="n">T</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span><span class="o">)</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">T</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">All</span> <span class="n">P</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">cons</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">x</span> <span class="n">L</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">-&gt;</span> <span class="n">All</span> <span class="n">P</span> <span class="n">L</span> <span class="bp">-&gt;</span> <span class="n">All</span> <span class="n">P</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">L</span><span class="o">)</span>

<span class="kd">inductive</span> <span class="n">Sorted</span> <span class="o">:</span> <span class="n">List</span> <span class="n">Nat</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">Sorted</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">cons</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span> <span class="n">l</span><span class="o">,</span> <span class="n">Sorted</span> <span class="n">l</span> <span class="bp">-&gt;</span> 
                     <span class="n">All</span> <span class="o">(</span><span class="n">Nat.le</span> <span class="n">n</span><span class="o">)</span> <span class="n">l</span> <span class="bp">-&gt;</span>
                     <span class="n">Sorted</span> <span class="o">(</span><span class="n">n</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span>


<span class="kd">theorem</span> <span class="n">all_trans</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">T</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">Q</span> <span class="o">:</span> <span class="n">T</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span><span class="o">)</span> <span class="n">L</span><span class="o">,</span>
  <span class="n">All</span> <span class="n">P</span> <span class="n">L</span> <span class="bp">-&gt;</span>
  <span class="o">(</span><span class="k">forall</span> <span class="n">x</span><span class="o">,</span> <span class="n">P</span> <span class="n">x</span> <span class="bp">-&gt;</span> <span class="n">Q</span> <span class="n">x</span><span class="o">)</span> <span class="bp">-&gt;</span>
  <span class="n">All</span> <span class="n">Q</span> <span class="n">L</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="n">intros</span> <span class="n">P</span> <span class="n">Q</span> <span class="n">L</span> <span class="n">Hall</span> <span class="n">PtoQ</span>
    <span class="n">induction</span> <span class="n">Hall</span>
    <span class="n">case</span> <span class="n">nil</span> <span class="bp">=&gt;</span> <span class="n">constructor</span>
    <span class="n">case</span> <span class="n">cons</span> <span class="n">P</span> <span class="n">x</span> <span class="n">L</span> <span class="n">Px</span> <span class="n">HL</span> <span class="bp">=&gt;</span>
      <span class="n">constructor</span>
      <span class="n">apply</span> <span class="n">PtoQ</span>
      <span class="n">assumption</span>
      <span class="n">assumption</span>

<span class="c1">-- 23 lines</span>
<span class="kd">theorem</span> <span class="n">insert_le</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">n</span> <span class="n">x</span> <span class="n">l</span><span class="o">,</span>
  <span class="n">All</span> <span class="o">(</span><span class="n">Nat.le</span> <span class="n">n</span><span class="o">)</span> <span class="n">l</span> <span class="bp">-&gt;</span>
  <span class="n">Nat.le</span> <span class="n">n</span> <span class="n">x</span> <span class="bp">-&gt;</span>
  <span class="n">All</span> <span class="o">(</span><span class="n">Nat.le</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">insert</span> <span class="n">x</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>


<span class="kd">theorem</span> <span class="n">ble_inv</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> 
                  <span class="n">Nat.ble</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">false</span>
               <span class="bp">-&gt;</span> <span class="n">Nat.ble</span> <span class="n">b</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">true</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">H</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.ble_eq</span><span class="o">]</span>
    <span class="n">cases</span> <span class="o">(</span><span class="n">Nat.le_total</span> <span class="n">b</span> <span class="n">a</span><span class="o">)</span>
    <span class="n">assumption</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">&lt;-</span> <span class="n">Nat.not_lt_eq</span><span class="o">]</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">&lt;-</span> <span class="n">Bool.not_eq_true</span><span class="o">]</span> <span class="n">at</span> <span class="n">H</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">Nat.ble_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">H</span>
    <span class="n">contradiction</span>

<span class="c1">-- 37 lines</span>
<span class="kd">theorem</span> <span class="n">insert_sorted</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">x</span> <span class="n">l</span><span class="o">,</span> 
  <span class="n">Sorted</span> <span class="n">l</span> <span class="bp">-&gt;</span>
  <span class="n">Sorted</span> <span class="o">(</span><span class="n">insert</span> <span class="n">x</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 8 lines</span>
<span class="kd">theorem</span> <span class="n">isort_sorted</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">l</span><span class="o">,</span> <span class="n">Sorted</span> <span class="o">(</span><span class="n">isort</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="kd">inductive</span> <span class="n">Permutation</span> <span class="o">:</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">T</span> <span class="bp">-&gt;</span> <span class="n">List</span> <span class="n">T</span> <span class="bp">-&gt;</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">nil</span>   <span class="o">:</span> <span class="n">Permutation</span> <span class="o">[]</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">skip</span>  <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="n">l'</span> <span class="o">:</span> <span class="n">List</span> <span class="n">A</span><span class="o">),</span>
          <span class="n">Permutation</span> <span class="n">l</span> <span class="n">l'</span> <span class="bp">-&gt;</span>
          <span class="n">Permutation</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">l'</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">swap</span>  <span class="o">:</span> <span class="k">forall</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">A</span><span class="o">),</span>
          <span class="n">Permutation</span> <span class="o">(</span><span class="n">y</span> <span class="o">::</span> <span class="n">x</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">y</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">trans</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">l</span> <span class="n">l'</span> <span class="n">l''</span> <span class="o">:</span> <span class="n">List</span> <span class="n">A</span><span class="o">,</span>
          <span class="n">Permutation</span> <span class="n">l</span> <span class="n">l'</span> <span class="bp">-&gt;</span>
          <span class="n">Permutation</span> <span class="n">l'</span> <span class="n">l''</span> <span class="bp">-&gt;</span>
          <span class="n">Permutation</span> <span class="n">l</span> <span class="n">l''</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">Permutation</span> <span class="o">[</span><span class="n">true</span><span class="o">,</span><span class="n">true</span><span class="o">,</span><span class="n">false</span><span class="o">]</span> <span class="o">[</span><span class="n">false</span><span class="o">,</span><span class="n">true</span><span class="o">,</span><span class="n">true</span><span class="o">]</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="n">apply</span> <span class="n">Permutation.trans</span> <span class="o">(</span><span class="n">l'</span> <span class="o">:=</span> <span class="o">[</span><span class="n">true</span><span class="o">,</span><span class="n">false</span><span class="o">,</span><span class="n">true</span><span class="o">])</span>
    <span class="bp">.</span> <span class="n">apply</span> <span class="n">Permutation.skip</span>
      <span class="n">apply</span> <span class="n">Permutation.swap</span>
    <span class="bp">.</span> <span class="n">apply</span> <span class="n">Permutation.swap</span>

<span class="c1">-- 6 lines</span>
<span class="kd">theorem</span> <span class="n">perm_refl</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">List</span> <span class="n">T</span><span class="o">),</span> 
  <span class="n">Permutation</span> <span class="n">l</span> <span class="n">l</span> <span class="o">:=</span> 
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 10 lines</span>
<span class="kd">theorem</span> <span class="n">perm_length</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="o">:</span> <span class="n">List</span> <span class="n">T</span><span class="o">),</span> 
  <span class="n">Permutation</span> <span class="n">l1</span> <span class="n">l2</span> <span class="bp">-&gt;</span> <span class="n">l1.length</span> <span class="bp">=</span> <span class="n">l2.length</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 12 lines</span>
<span class="kd">theorem</span> <span class="n">perm_sym</span> <span class="o">:</span> <span class="k">forall</span> <span class="o">{</span><span class="n">T</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">l1</span> <span class="n">l2</span> <span class="o">:</span> <span class="n">List</span> <span class="n">T</span><span class="o">),</span> 
  <span class="n">Permutation</span> <span class="n">l1</span> <span class="n">l2</span> <span class="bp">-&gt;</span> <span class="n">Permutation</span> <span class="n">l2</span> <span class="n">l1</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 18 lines</span>
<span class="kd">theorem</span> <span class="n">insert_perm</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">x</span> <span class="n">l</span><span class="o">,</span> 
  <span class="n">Permutation</span> <span class="o">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span> <span class="o">(</span><span class="n">insert</span> <span class="n">x</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>

<span class="c1">-- 10 lines</span>
<span class="kd">theorem</span> <span class="n">isort_perm</span> <span class="o">:</span> <span class="k">forall</span> <span class="n">l</span><span class="o">,</span> <span class="n">Permutation</span> <span class="n">l</span> <span class="o">(</span><span class="n">isort</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span>
 <span class="kd">by</span> <span class="gr">sorry</span>
</pre>
</div>
</div>
<div class="navsetbottom">
<span class="navleft">
<div class="nosearchform"></div>
&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="hw7.html" title="backward to &quot;6 Homework 7&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="hw10.html" title="forward to &quot;8 Homework 10&quot;" data-pltdoc="x">next →</a></span>&nbsp;
</div>
</div>
</div>
<div id="contextindicator">
&nbsp;
</div>
</body>
</html>
