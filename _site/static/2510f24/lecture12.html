<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ["$","$"], ["\\(","\\)"] ],
    displayMath: [ ["$$","$$"], 
                   ["\\[","\\]"], 
                   ["\\begin{equation}","\\end{equation}"], 
                   ["\\begin{equation*}","\\end{equation*}"] ],
    processEscapes: true,
    ignoreClass: "tex2jax_ignore|JavaHighlightBlock|JavaHighlight"
  },
  "HTML-CSS": {
    availableFonts: [],
    webFont: "Asana-Math",
    preferredFont: "Asana-Math",
    imageFont: null,
    mtexFontInherit: true
  }
});
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="codemirror.js"></script>
  <script src="python.js"></script>
  <script src="runmode.js"></script>
  <script src="setup-page.js"></script>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.8">
  <title>
   dbp.io
  </title>
  <link rel="stylesheet" type="text/css" href="scribble.css" title="default">
  <link rel="stylesheet" type="text/css" href="racket.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-style.css" title="default">
  <link rel="stylesheet" type="text/css" href="manual-racket.css" title="default">
  <link rel="stylesheet" type="text/css" href="extra-styles.css" title="default">
  <link rel="stylesheet" type="text/css" href="codemirror.css" title="default">
  <script type="text/javascript" src="scribble-common.js"></script>
  <script type="text/javascript" src="manual-racket.js"></script>
 </head>
 <body id="scribble-racket-lang-org">
  <div class="tocset">
   <div class="tocview">
    <div class="tocviewlist tocviewlisttopspace">
     <div class="tocviewtitle">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td style="width: 1em;">
          <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a>
         </td>
         <td></td>
         <td>
          <a href="index.html" class="tocviewlink" data-pltdoc="x">Fundamentals II
<br>
Introduction to Class-<wbr>based Program Design</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
     <div class="tocviewsublisttop" style="display: none;" id="tocview_0">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="General.html" class="tocviewlink" data-pltdoc="x">General</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Texts.html" class="tocviewlink" data-pltdoc="x">Texts</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Lectures.html" class="tocviewselflink" data-pltdoc="x">Lectures</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Lab_Materials.html" class="tocviewlink" data-pltdoc="x">Lab Materials</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Assignments.html" class="tocviewlink" data-pltdoc="x">Assignments</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Pair_Programming_Overview.html" class="tocviewlink" data-pltdoc="x">Pair Programming Overview</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="code-style.html" class="tocviewlink" data-pltdoc="x">Code style</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="Documentation.html" class="tocviewlink" data-pltdoc="x">Documentation</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a>
        </td>
        <td></td>
        <td>
         <a href="Lectures.html" class="tocviewlink" data-pltdoc="x">Lectures</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublist" style="display: block;" id="tocview_1">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture1.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 1:</span> Data Definitions in Java</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture2.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 2:</span> Data Definitions:<span class="mywbr"> &nbsp;</span> Unions</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture3.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 3:</span> Methods for simple classes</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture4.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 4:</span> Methods for unions</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture5.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 5:</span> Methods for self-<wbr>referential lists</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture6.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 6:</span> Accumulator methods</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture7.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 7:</span> Accumulator methods, continued</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture8.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 8:</span> Practice Design</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture9.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 9:</span> Abstract classes and inheritance</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture10.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 10:</span> Customizing constructors for correctness and convenience</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture11.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 11:</span> Defining sameness for complex data, part 1</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="" class="tocviewselflink" data-pltdoc="x"><span class="LectureNum">Lecture 12:</span> Defining sameness for complex data, part 2</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture13.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 13:</span> Abstracting over behavior</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture14.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 14:</span> Abstractions over more than one argument</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture15.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 15:</span> Abstracting over types</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture16.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 16:</span> Visitors</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture17.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 17:</span> Mutation</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture18.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 18:</span> Mutation inside structures</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture19.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 19:</span> Mutation, aliasing and testing</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture20.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 20:</span> Mutable data structures</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture21.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 21:</span> Array<span class="mywbr"> &nbsp;</span>Lists</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture22.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 22:</span> Array<span class="mywbr"> &nbsp;</span>Lists</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture23.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 23:</span> For-<wbr>each loops and Counted-<wbr>for loops</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture24.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 24:</span> While loops</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture25.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 25:</span> Iterator and Iterable</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture26.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 26:</span> Hashing and Equality</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture27.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 27:</span> Introduction to Big-<span style="font-style: italic">O</span> Analysis</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture28.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 28:</span> Quicksort and Mergesort</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture29.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 29:</span> Priority Queues and Heapsort</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture30.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 30:</span> Breadth-<wbr>first search and Depth-<wbr>first search on graphs</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture31.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 31:</span> Dijkstra’s Algorithm for single-<wbr>source shortest paths</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture32.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 32:</span> Minimum Spanning Trees</a>
         </td>
        </tr>
        <tr>
         <td align="right"></td>
         <td>
          <a href="lecture33.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 33:</span> Implementing Objects</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
    <div class="tocviewlist">
     <table cellspacing="0" cellpadding="0">
      <tbody>
       <tr>
        <td style="width: 1em;">
         <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">►</a>
        </td>
        <td></td>
        <td>
         <a href="" class="tocviewselflink" data-pltdoc="x"><span class="LectureNum">Lecture 12:</span> Defining sameness for complex data, part 2</a>
        </td>
       </tr>
      </tbody>
     </table>
     <div class="tocviewsublistbottom" style="display: none;" id="tocview_2">
      <table cellspacing="0" cellpadding="0">
       <tbody>
        <tr>
         <td align="right"></td>
         <td>
          <a href="#%28part._.Motivation%29" class="tocviewlink" data-pltdoc="x">Motivation</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          12.1&nbsp;
         </td>
         <td>
          <a href="#%28part._.Sameness_for_unions__.Successful_attempt_using_double-dispatch%29" class="tocviewlink" data-pltdoc="x">Sameness for unions:<span class="mywbr"> &nbsp;</span> Successful attempt using double-<wbr>dispatch</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          12.2&nbsp;
         </td>
         <td>
          <a href="#%28part._.Summarizing_the_double-dispatch_pattern_for_sameness_testing%29" class="tocviewlink" data-pltdoc="x">Summarizing the double-<wbr>dispatch pattern for sameness testing</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          12.3&nbsp;
         </td>
         <td>
          <a href="#%28part._.Cleaning_up_the_code%29" class="tocviewlink" data-pltdoc="x">Cleaning up the code</a>
         </td>
        </tr>
        <tr>
         <td align="right">
          12.4&nbsp;
         </td>
         <td>
          <a href="#%28part._.Adding_more_variants%29" class="tocviewlink" data-pltdoc="x">Adding more variants</a>
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="tocsub">
    <div class="tocsubtitle">
     On this page:
    </div>
    <table class="tocsublist" cellspacing="0">
     <tbody>
      <tr>
       <td>
        <span class="tocsublinknumber"></span><a href="#%28part._.Motivation%29" class="tocsubseclink" data-pltdoc="x">Motivation</a>
       </td>
      </tr>
      <tr>
       <td>
        <span class="tocsublinknumber">12.1
        <tt>
         &nbsp;
        </tt>
       </span>
       <a href="#%28part._.Sameness_for_unions__.Successful_attempt_using_double-dispatch%29" class="tocsubseclink" data-pltdoc="x">Sameness for unions:<span class="mywbr"> &nbsp;</span> Successful attempt using double-<wbr>dispatch</a>
      </td>
     </tr>
     <tr>
      <td>
       <span class="tocsublinknumber">12.2
       <tt>
        &nbsp;
       </tt>
      </span>
      <a href="#%28part._.Summarizing_the_double-dispatch_pattern_for_sameness_testing%29" class="tocsubseclink" data-pltdoc="x">Summarizing the double-<wbr>dispatch pattern for sameness testing</a>
     </td>
    </tr>
    <tr>
     <td>
      <span class="tocsublinknumber">12.3
      <tt>
       &nbsp;
      </tt>
     </span>
     <a href="#%28part._.Cleaning_up_the_code%29" class="tocsubseclink" data-pltdoc="x">Cleaning up the code</a>
    </td>
   </tr>
   <tr>
    <td>
     <span class="tocsublinknumber">12.4
     <tt>
      &nbsp;
     </tt>
    </span>
    <a href="#%28part._.Adding_more_variants%29" class="tocsubseclink" data-pltdoc="x">Adding more variants</a>
   </td>
  </tr>
 </tbody>
</table>
</div>
</div>
<div class="maincolumn">
<div class="main">
<div class="versionbox">
 <span class="version">8.14</span>
</div>
<div class="navsettop">
 <span class="navleft">
 <div class="nosearchform"></div>
 &nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="lecture11.html" title="backward to &quot;Lecture 11: Defining sameness for complex data, part 1&quot;" data-pltdoc="x" rel="prev">← prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture13.html" title="forward to &quot;Lecture 13: Abstracting over behavior&quot;" data-pltdoc="x" rel="next">next →</a></span>&nbsp;
</div>
<h4 class="heading">
<a name="(part._)"></a><span class="LectureNum">Lecture 12:</span> Defining sameness for complex data, part 2<span class="button-group"><a href="#(part._)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h4>
<p class="boxed">
Using double-dispatch to test for sameness
</p>
<h5 class="heading">
<a name="(part._.Motivation)"></a>Motivation<span class="button-group"><a href="#(part._.Motivation)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h5>
<p>
In <a href="lecture11.html" data-pltdoc="x"><span class="LectureNum">Lecture 11:</span> Defining sameness for complex data, part 1</a> we took up the question, “How can we test when two values are ‘the same’?”
We introduced two new language mechanisms: <span class="emph">casting</span> to try to convince Java to treat an identifier
as if it were declared at a more specific type, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">instanceof</span><span class="RktMeta"></span></span></span> to check whether a given value
actually is of a particular type.  But our implementations were brittle and suffered from clumsy
helper methods that were not useful outside this limited context, and still potentially could
throw exceptions and crash.  Plus, our design sense should be warning us: any time we feel tempted
to try to do a type-test in Java, we ought to find a better way...preferably using dynamic dispatch.
</p>
<p></p>
<div class="SIntrapara">
Recall our desired properties for a sameness test:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span style="font-weight: bold">Reflexivity:</span> every object should be the same as itself.
  </p>
 </li>
 <li>
  <p>
   <span style="font-weight: bold">Symmetry:</span> if object <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">x</span><span class="RktMeta"></span></span></span> is the same as object <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">y</span><span class="RktMeta"></span></span></span>, then <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">y</span><span class="RktMeta"></span></span></span> is the same as <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">x</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   <span style="font-weight: bold">Transitivity:</span> if two objects are both the same as a third object, then they are the same as each other.
  </p>
 </li>
 <li>
  <p>
   <span style="font-weight: bold">Totality:</span> we can compare any two objects of the same type, and obtain a correct answer.
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
Let’s also bring back our tests from last time:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In test method in an Examples class
</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">c1</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Circle</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">c2</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Circle</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">6</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">c3</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Circle</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">r1</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Rect</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">r2</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Rect</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">6</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">7</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">r3</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Rect</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">s1</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Square</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">s2</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Square</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">6</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">s3</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Square</span><span class="ProfjKeyword">(</span><span class="ProfjLiteral">3</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">4</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">5</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjError">&nbsp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c2</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c2</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c3</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c3</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjError">&nbsp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r2</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r2</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r3</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r3</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjError">&nbsp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s2</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s2</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s3</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s3</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjError">&nbsp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// Comparing a Square with a Rect of a different size
</span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r2</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r2</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// Comparing a Square with a Rect of the same size
</span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<p></p>
<p>
To design a better mechanism for checking sameness...we have actually already written nearly
all the helpers we need.  We just need to use them more cleverly!
</p>
<h5 class="heading">
12.1
<tt>
 &nbsp;
</tt>
<a name="(part._.Sameness_for_unions__.Successful_attempt_using_double-dispatch)"></a>Sameness for unions: Successful attempt using double-dispatch<span class="button-group"><a href="#(part._.Sameness_for_unions__.Successful_attempt_using_double-dispatch)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h5>
<p></p>
<div class="SIntrapara">
Let’s retrace our steps to see what went wrong when trying to define <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> for the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>
class:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Circle:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjBlockComment">/*
   * Fields:
   * this.x, this.y, this.radius
   *
   * Methods:
   * this.sameShape(IShape) -&gt; boolean
   * this.sameCircle(Circle) -&gt; boolean
   *
   * Methods on fields:
   *
   * Fields of parameters:
   *
   * Methods on parameters:
   * that.sameShape(IShape) -&gt; boolean
   */</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">   </span><span class="ProfjKeyword">?</span><span class="ProfjKeyword">?</span><span class="ProfjKeyword">?</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
We had nothing in our template that we could use: we didn’t have enough information about
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> to determine what sort of shape it was.
</div>
<p></p>
<p></p>
<div class="SIntrapara">
Suppose we had the following idea: the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span>
methods were at least somewhat useful, so let’s add those methods to the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>
interface.
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">interface</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
<blockquote class="IncerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Incercise">
   Do Now!
  </p>
 </div>
 <div class="SIntrapara">
  Now the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span> class needs implementations for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span>,
the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class is missing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span>,
and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> is missing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span>.
Implement them —<wbr> they should be very short!
 </div>
 <p></p>
</blockquote>
</div>
<div class="SIntrapara">
Now let’s look at how our template has changed:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Circle:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjBlockComment">/*
   * Fields:
   * this.x, this.y, this.radius
   *
   * Methods:
   * this.sameShape(IShape) -&gt; boolean
   * this.sameCircle(Circle) -&gt; boolean
   * this.sameRect(Rect) -&gt; boolean
   * this.sameSquare(Square) -&gt; boolean
   *
   * Methods on fields:
   *
   * Fields of parameters:
   *
   * Methods on parameters:
   * that.sameShape(IShape) -&gt; boolean
   * that.sameCircle(Circle) -&gt; boolean
   * that.sameRect(Rect) -&gt; boolean
   * that.sameSquare(Square) -&gt; boolean
   */</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">   </span><span class="ProfjKeyword">?</span><span class="ProfjKeyword">?</span><span class="ProfjKeyword">?</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
We have several more methods to choose from; perhaps we can use one of them to finish our method.
</div>
<div class="SIntrapara">
<blockquote class="IncerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Incercise">
   Do Now!
  </p>
 </div>
 <div class="SIntrapara">
  Looking at the types for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, which method in the template
is most likely to be useful?
 </div>
 <p></p>
</blockquote>
</div>
<div class="SIntrapara">
<blockquote class="refpara">
 <blockquote class="refcolumn">
  <blockquote class="refcontent">
   <p>
    We’d be going around in circles...
   </p>
  </blockquote>
 </blockquote>
</blockquote>
</div>
<div class="SIntrapara">
We could try invoking <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>, but that doesn’t really make any progress.  (In fact,
if <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is also a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, we’d end up stuck in an infinite recursion, with no base case.)
We know that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is some <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>.  And we know—<wbr>because we’re in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span> class—<wbr>that
<span class="emph"><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span></span>, and not just another <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>.  Which means we can invoke
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> using <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> as the argument:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Circle:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
And we’re done!  Let’s trace through a few examples: if we test <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c3</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, so we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method defined in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c3</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   This method immediately invokes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, and passes it <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span>.
Because <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c3</span><span class="RktMeta"></span></span></span>, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c3</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> method
defined in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span> class, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c3</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> —<wbr> they’ve swapped roles.
  </p>
 </li>
 <li>
  <p>
   Inside <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is now <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c3</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is now <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span>, and we can easily compare
their fields.  The fields are all equal, so we return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">true</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
If we try a similar test with <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">c2</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, so we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method defined in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c2</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   This method immediately invokes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, and passes it <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span>.
Because <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c2</span><span class="RktMeta"></span></span></span>, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c2</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> method
defined in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span> class, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c2</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> —<wbr> they’ve swapped roles.
  </p>
 </li>
 <li>
  <p>
   Inside <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is now <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c2</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is now <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span>, and we can easily compare
their fields.  The fields are not equal, so we return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
Perfect —<wbr> we can compare <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>s correctly.
</div>
<p></p>
<p></p>
<div class="SIntrapara">
Let’s try something trickier: let’s test <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, so we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method defined in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   This method immediately invokes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, and passes it <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span>.
Because <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span>, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>, we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> method
defined in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">c1</span><span class="RktMeta"></span></span></span> —<wbr> they’ve swapped roles.
  </p>
 </li>
 <li>
  <p>
   ...
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
Oops —<wbr> we haven’t implemented <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> for the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class yet.  But it’s easy: read through the purpose statement in your head,
“when is this <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> the same <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span> as that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>?”  Answer: never!
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Rect
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
In fact, we can implement all the “mismatched” methods this way:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Circle
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace">     </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Rect
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Square
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace">     </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
With these methods defined, we can finish the trace above:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   The <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameCircle</span><span class="RktMeta"></span></span></span> method in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class always returns <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>: <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>s and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>s are never the same.
  </p>
 </li>
</ul>
</div>
<p></p>
<p></p>
<div class="SIntrapara">
Now let’s try the two trickiest examples: comparing a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> with a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> and symmetrically a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> with a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<blockquote class="IncerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Incercise">
   Do Now!
  </p>
 </div>
 <div class="SIntrapara">
  Do this yourself, following the pattern of the step-by-step walkthroughs above.
 </div>
 <p></p>
</blockquote>
</div>
<div class="SIntrapara">
To compare <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">r1</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>, so we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method defined in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   This method immediately invokes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, and passes it <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span>.
Because <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span>, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>, we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span> method
defined in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span> —<wbr> they’ve swapped roles.
  </p>
 </li>
 <li>
  <p>
   The <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameSquare</span><span class="RktMeta"></span></span></span> method in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> class always returns <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>: <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>s and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>s are never the same.
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
Conversely, to compare <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">s1</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>:
</div>
<div class="SIntrapara">
<ul>
 <li>
  <p>
   <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>, so we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method defined in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span>.
  </p>
 </li>
 <li>
  <p>
   This method immediately invokes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span>, and passes it <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span>.
Because <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span>, and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span> is a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>, we invoke the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span> method
defined in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> class, inside of which <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">s1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">that</span><span class="RktMeta"></span></span></span> will be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">r1</span><span class="RktMeta"></span></span></span> —<wbr> they’ve swapped roles.
  </p>
 </li>
 <li>
  <p>
   The <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameRect</span><span class="RktMeta"></span></span></span> method in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> class always returns <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>: <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>s and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span>s are never the same.
  </p>
 </li>
</ul>
</div>
<div class="SIntrapara">
Perfect!
</div>
<p></p>
<h5 class="heading">
12.2
<tt>
 &nbsp;
</tt>
<a name="(part._.Summarizing_the_double-dispatch_pattern_for_sameness_testing)"></a>Summarizing the double-dispatch pattern for sameness testing<span class="button-group"><a href="#(part._.Summarizing_the_double-dispatch_pattern_for_sameness_testing)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h5>
<p></p>
<div class="SIntrapara">
Suppose we have an interface <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span>, and classes <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">X</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Y</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Z</span><span class="RktMeta"></span></span></span> that implement this interface.
In the interface, we define a method <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameFoo</span><span class="RktMeta"></span></span></span> that takes an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span>, and we define one method for
each class that implements the interface:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">interface</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameFoo</span><span class="ProfjKeyword">(</span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjError">&nbsp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameY</span><span class="ProfjKeyword">(</span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameZ</span><span class="ProfjKeyword">(</span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
In each class, the interesting behavior is in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameFoo</span><span class="RktMeta"></span></span></span> method and the method with the same name as the class:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In X:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameFoo</span><span class="ProfjKeyword">(</span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">compares</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">two</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">values</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
All the other methods just return false:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In X:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameY</span><span class="ProfjKeyword">(</span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameZ</span><span class="ProfjKeyword">(</span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<p></p>
<p>
How does this all work?  The key observation is that when we want to compare two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span> values <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f2</span><span class="RktMeta"></span></span></span> for sameness,
we need to determine which kind of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span> <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span> is, <span class="emph">and also</span> which kind of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span> <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f2</span><span class="RktMeta"></span></span></span> is.
We get the answer to the first part automatically: by invoking a method on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span>, dynamic dispatch will
automatically route us to the appropriate method for the actual type of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span>.  Then,
instead of trying to cobble together some form of type testing to figure out the answer for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f2</span><span class="RktMeta"></span></span></span>,
we just invoke a method on it, using dispatch again to figure out the answer there.  The trick lies
in using our helper methods cleverly: by having <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameFoo</span><span class="RktMeta"></span></span></span> invoke <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameX</span><span class="RktMeta"></span></span></span> (in the example above),
we are essentially answering the question “is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span> the same <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IFoo</span><span class="RktMeta"></span></span></span> as <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f2</span><span class="RktMeta"></span></span></span>?” by rebounding
the question: “well we’ve figured out that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span> is an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">X</span><span class="RktMeta"></span></span></span>, so is <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f2</span><span class="RktMeta"></span></span></span> the same <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">X</span><span class="RktMeta"></span></span></span> as <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">f1</span><span class="RktMeta"></span></span></span>?”
</p>
<p></p>
<div class="SIntrapara">
This pattern, of using <span class="emph">two</span> method invocations to get the benefits of dynamic dispatch twice, is called <span class="emph">double dispatch</span>,
and it is a very common and very elegant pattern.
</div>
<div class="SIntrapara">
<blockquote class="ExerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Exercise">
   Exercise
  </p>
 </div>
 <div class="SIntrapara">
  Look back at <a href="lecture7.html" data-pltdoc="x"><span class="LectureNum">Lecture 7:</span> Accumulator methods, continued</a>.  Where did we use the double-dispatch pattern to answer a similar kind of question,
that had to distinguish between different variants of a union data type?
 </div>
 <p></p>
</blockquote>
</div>
<div class="SIntrapara">
<blockquote class="IncerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Incercise">
   Do Now!
  </p>
 </div>
 <div class="SIntrapara">
  Confirm that all of the properties we want out of a sameness operation are satisfied by our implementation.
Notice in particular that totality is easy to confirm: there are no exceptions possible in this code!
 </div>
 <p></p>
</blockquote>
</div>
<div class="SIntrapara">
<blockquote class="ExerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Exercise">
   Exercise
  </p>
 </div>
 <div class="SIntrapara">
  Implement a sameness operator for two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IAT</span><span class="RktMeta"></span></span></span> ancestry trees.
 </div>
 <p></p>
</blockquote>
</div>
<p></p>
<h5 class="heading">
12.3
<tt>
 &nbsp;
</tt>
<a name="(part._.Cleaning_up_the_code)"></a>Cleaning up the code<span class="button-group"><a href="#(part._.Cleaning_up_the_code)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h5>
<p></p>
<div class="SIntrapara">
You may have noticed that there are a <span class="emph">lot</span> of methods in the pattern above that always return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>.
(For <span class="emph">n</span> variants, there are <span class="emph">n * n</span> helper methods, of which <span class="emph">n * (n - 1)</span> of them should always return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>.)
In fact, all of the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">same</span><span class="RktMeta"></span></span></span><span class="emph"><span class="stt">Class</span></span> methods always return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>, except in one case in each class.
This sort of pattern, where the behavior is always the same except for a few cases where it differs, calls for the
abstraction recipe for methods: we create an abstract class, put the default versions of these methods in there once and for all,
then override them as needed in each subclass:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">abstract</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">implements</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameY</span><span class="ProfjKeyword">(</span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameZ</span><span class="ProfjKeyword">(</span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">extends</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameFoo</span><span class="ProfjKeyword">(</span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameX</span><span class="ProfjKeyword">(</span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">compares</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">two</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">X</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">values</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">extends</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameFoo</span><span class="ProfjKeyword">(</span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameY</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameY</span><span class="ProfjKeyword">(</span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">compares</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">two</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Y</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">values</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">extends</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameFoo</span><span class="ProfjKeyword">(</span><span class="ProfjType">IFoo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameZ</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameZ</span><span class="ProfjKeyword">(</span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">compares</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">two</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Z</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">values</span><span class="ProfjWhiteSpace"> </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
<blockquote class="ExerciseBody">
 <p></p>
 <div class="SIntrapara">
  <p class="Exercise">
   Exercise
  </p>
 </div>
 <div class="SIntrapara">
  Implement an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">AShape</span><span class="RktMeta"></span></span></span> class, and abstract all the default cases you can.  Be careful with the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> class!
 </div>
 <p></p>
</blockquote>
</div>
<p></p>
<h5 class="heading">
12.4
<tt>
 &nbsp;
</tt>
<a name="(part._.Adding_more_variants)"></a>Adding more variants<span class="button-group"><a href="#(part._.Adding_more_variants)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span>
</h5>
<p></p>
<div class="SIntrapara">
We also defined a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Combo</span><span class="RktMeta"></span></span></span> class as a kind of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>.  Let’s add it now, and implement sameness for it:
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">interface</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjComment">// NEW:
</span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCombo</span><span class="ProfjKeyword">(</span><span class="ProfjType">Combo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// in AShape:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCombo</span><span class="ProfjKeyword">(</span><span class="ProfjType">Combo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
Notice that because of inheritance from <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">AShape</span><span class="RktMeta"></span></span></span>, we don’t need to change <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> or <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> at all.
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// in Combo:
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCombo</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCombo</span><span class="ProfjKeyword">(</span><span class="ProfjType">Combo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="ProfjDefault">.</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
To compare two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Combo</span><span class="RktMeta"></span></span></span>s for sameness, we need to compare their <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">left</span><span class="RktMeta"></span></span></span> sides for sameness and their <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">right</span><span class="RktMeta"></span></span></span> sides for sameness.
Both <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">left</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">right</span><span class="RktMeta"></span></span></span> are <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>s; conveniently, we have a method to compare two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>s for sameness!
</div>
<div class="SIntrapara">
<div class="JavaHighlightBlock">
 <blockquote class="SCodeFlow">
  <table cellspacing="0" cellpadding="0" class="RktBlk">
   <tbody>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjComment">// In Combo
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCombo</span><span class="ProfjKeyword">(</span><span class="ProfjType">Combo</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">left</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">left</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">&amp;&amp;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjWhiteSpace">         </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">right</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">right</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span>
     </td>
    </tr>
    <tr>
     <td>
      <span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span>
     </td>
    </tr>
   </tbody>
  </table>
 </blockquote>
</div>
</div>
<div class="SIntrapara">
Trace through a few examples to convince yourself that this method—<wbr>using double dispatch in recursive calls!—<wbr>works properly.
</div>
<p></p>
<div class="navsetbottom">
<span class="navleft">
<div class="nosearchform"></div>
&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span>
</span>
<span class="navright">&nbsp;&nbsp;<a href="lecture11.html" title="backward to &quot;Lecture 11: Defining sameness for complex data, part 1&quot;" data-pltdoc="x" rel="prev">← prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture13.html" title="forward to &quot;Lecture 13: Abstracting over behavior&quot;" data-pltdoc="x" rel="next">next →</a></span>&nbsp;
</div>
</div>
</div>
<div id="contextindicator">
&nbsp;
</div>
</body>
</html>
