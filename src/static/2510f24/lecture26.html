<!doctype HTML>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ["$","$"], ["\\(","\\)"] ],
    displayMath: [ ["$$","$$"], 
                   ["\\[","\\]"], 
                   ["\\begin{equation}","\\end{equation}"], 
                   ["\\begin{equation*}","\\end{equation*}"] ],
    processEscapes: true,
    ignoreClass: "tex2jax_ignore|JavaHighlightBlock|JavaHighlight"
  },
  "HTML-CSS": {
    availableFonts: [],
    webFont: "Asana-Math",
    preferredFont: "Asana-Math",
    imageFont: null,
    mtexFontInherit: true
  }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="codemirror.js"></script>
<script src="python.js"></script>
<script src="runmode.js"></script>
<script src="setup-page.js"></script>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Lecture 26: Hashing and Equality</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="extra-styles.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Fundamentals II
<br/>
Introduction to Class-<wbr></wbr>based Program Design</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="General.html" class="tocviewlink" data-pltdoc="x">General</a></td></tr><tr><td align="right"></td><td><a href="Texts.html" class="tocviewlink" data-pltdoc="x">Texts</a></td></tr><tr><td align="right"></td><td><a href="Lectures.html" class="tocviewselflink" data-pltdoc="x">Lectures</a></td></tr><tr><td align="right"></td><td><a href="Syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a></td></tr><tr><td align="right"></td><td><a href="Lab_Materials.html" class="tocviewlink" data-pltdoc="x">Lab Materials</a></td></tr><tr><td align="right"></td><td><a href="Assignments.html" class="tocviewlink" data-pltdoc="x">Assignments</a></td></tr><tr><td align="right"></td><td><a href="Pair_Programming_Overview.html" class="tocviewlink" data-pltdoc="x">Pair Programming Overview</a></td></tr><tr><td align="right"></td><td><a href="code-style.html" class="tocviewlink" data-pltdoc="x">Code style</a></td></tr><tr><td align="right"></td><td><a href="Documentation.html" class="tocviewlink" data-pltdoc="x">Documentation</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td></td><td><a href="Lectures.html" class="tocviewlink" data-pltdoc="x">Lectures</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="lecture1.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 1:</span> Data Definitions in Java</a></td></tr><tr><td align="right"></td><td><a href="lecture2.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 2:</span> Data Definitions:<span class="mywbr"> &nbsp;</span> Unions</a></td></tr><tr><td align="right"></td><td><a href="lecture3.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 3:</span> Methods for simple classes</a></td></tr><tr><td align="right"></td><td><a href="lecture4.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 4:</span> Methods for unions</a></td></tr><tr><td align="right"></td><td><a href="lecture5.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 5:</span> Methods for self-<wbr></wbr>referential lists</a></td></tr><tr><td align="right"></td><td><a href="lecture6.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 6:</span> Accumulator methods</a></td></tr><tr><td align="right"></td><td><a href="lecture7.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 7:</span> Accumulator methods, continued</a></td></tr><tr><td align="right"></td><td><a href="lecture8.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 8:</span> Practice Design</a></td></tr><tr><td align="right"></td><td><a href="lecture9.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 9:</span> Abstract classes and inheritance</a></td></tr><tr><td align="right"></td><td><a href="lecture10.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 10:</span> Customizing constructors for correctness and convenience</a></td></tr><tr><td align="right"></td><td><a href="lecture11.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 11:</span> Defining sameness for complex data, part 1</a></td></tr><tr><td align="right"></td><td><a href="lecture12.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 12:</span> Defining sameness for complex data, part 2</a></td></tr><tr><td align="right"></td><td><a href="lecture13.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 13:</span> Abstracting over behavior</a></td></tr><tr><td align="right"></td><td><a href="lecture14.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 14:</span> Abstractions over more than one argument</a></td></tr><tr><td align="right"></td><td><a href="lecture15.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 15:</span> Abstracting over types</a></td></tr><tr><td align="right"></td><td><a href="lecture16.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 16:</span> Visitors</a></td></tr><tr><td align="right"></td><td><a href="lecture17.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 17:</span> Mutation</a></td></tr><tr><td align="right"></td><td><a href="lecture18.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 18:</span> Mutation inside structures</a></td></tr><tr><td align="right"></td><td><a href="lecture19.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 19:</span> Mutation, aliasing and testing</a></td></tr><tr><td align="right"></td><td><a href="lecture20.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 20:</span> Mutable data structures</a></td></tr><tr><td align="right"></td><td><a href="lecture21.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 21:</span> Array<span class="mywbr"> &nbsp;</span>Lists</a></td></tr><tr><td align="right"></td><td><a href="lecture22.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 22:</span> Array<span class="mywbr"> &nbsp;</span>Lists</a></td></tr><tr><td align="right"></td><td><a href="lecture23.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 23:</span> For-<wbr></wbr>each loops and Counted-<wbr></wbr>for loops</a></td></tr><tr><td align="right"></td><td><a href="lecture24.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 24:</span> While loops</a></td></tr><tr><td align="right"></td><td><a href="lecture25.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 25:</span> Iterator and Iterable</a></td></tr><tr><td align="right"></td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="LectureNum">Lecture 26:</span> Hashing and Equality</a></td></tr><tr><td align="right"></td><td><a href="lecture27.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 27:</span> Introduction to Big-<span style="font-style: italic">O</span> Analysis</a></td></tr><tr><td align="right"></td><td><a href="lecture28.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 28:</span> Quicksort and Mergesort</a></td></tr><tr><td align="right"></td><td><a href="lecture29.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 29:</span> Priority Queues and Heapsort</a></td></tr><tr><td align="right"></td><td><a href="lecture30.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 30:</span> Breadth-<wbr></wbr>first search and Depth-<wbr></wbr>first search on graphs</a></td></tr><tr><td align="right"></td><td><a href="lecture31.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 31:</span> Dijkstra&rsquo;s Algorithm for single-<wbr></wbr>source shortest paths</a></td></tr><tr><td align="right"></td><td><a href="lecture32.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 32:</span> Minimum Spanning Trees</a></td></tr><tr><td align="right"></td><td><a href="lecture33.html" class="tocviewlink" data-pltdoc="x"><span class="LectureNum">Lecture 33:</span> Implementing Objects</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="LectureNum">Lecture 26:</span> Hashing and Equality</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">26.1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">26.2&nbsp;</td><td><a href="#%28part._.Introducing_.Hash-tables%29" class="tocviewlink" data-pltdoc="x">Introducing Hash-<wbr></wbr>tables</a></td></tr><tr><td align="right">26.3&nbsp;</td><td><a href="#%28part._.Introducing_.Hash.Maps%29" class="tocviewlink" data-pltdoc="x">Introducing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Hash<span class="mywbr"> &nbsp;</span>Map</span><span class="RktMeta"></span></span></span>s</a></td></tr><tr><td align="right">26.4&nbsp;</td><td><a href="#%28part._.Hash_collisions%29" class="tocviewlink" data-pltdoc="x">Hash collisions</a></td></tr><tr><td align="right">26.5&nbsp;</td><td><a href="#%28part._hashcodes%29" class="tocviewlink" data-pltdoc="x">Hash codes and equality</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">26.1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">26.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Dictionaries%29" class="tocsubseclink" data-pltdoc="x">Dictionaries</a></td></tr><tr><td><span class="tocsublinknumber">26.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Wikis%29" class="tocsubseclink" data-pltdoc="x">Wikis</a></td></tr><tr><td><span class="tocsublinknumber">26.2<tt>&nbsp;</tt></span><a href="#%28part._.Introducing_.Hash-tables%29" class="tocsubseclink" data-pltdoc="x">Introducing Hash-<wbr></wbr>tables</a></td></tr><tr><td><span class="tocsublinknumber">26.3<tt>&nbsp;</tt></span><a href="#%28part._.Introducing_.Hash.Maps%29" class="tocsubseclink" data-pltdoc="x">Introducing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Hash<span class="mywbr"> &nbsp;</span>Map</span><span class="RktMeta"></span></span></span>s</a></td></tr><tr><td><span class="tocsublinknumber">26.4<tt>&nbsp;</tt></span><a href="#%28part._.Hash_collisions%29" class="tocsubseclink" data-pltdoc="x">Hash collisions</a></td></tr><tr><td><span class="tocsublinknumber">26.5<tt>&nbsp;</tt></span><a href="#%28part._hashcodes%29" class="tocsubseclink" data-pltdoc="x">Hash codes and equality</a></td></tr><tr><td><span class="tocsublinknumber">26.5.1<tt>&nbsp;</tt></span><a href="#%28part._.Defining_custom_hash.Codes%29" class="tocsubseclink" data-pltdoc="x">Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hash<span class="mywbr"> &nbsp;</span>Code</span><span class="RktMeta"></span></span></span>s</a></td></tr><tr><td><span class="tocsublinknumber">26.5.2<tt>&nbsp;</tt></span><a href="#%28part._.Defining_custom_equals_methods_for_simple_classes%29" class="tocsubseclink" data-pltdoc="x">Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for simple classes</a></td></tr><tr><td><span class="tocsublinknumber">26.5.3<tt>&nbsp;</tt></span><a href="#%28part._.Defining_custom_equals_methods_for_itemizations%29" class="tocsubseclink" data-pltdoc="x">Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for itemizations</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.14</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="lecture25.html" title="backward to &quot;Lecture 25: Iterator and Iterable&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture27.html" title="forward to &quot;Lecture 27: Introduction to Big-O Analysis&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div><h4 class="heading"><a name="(part._)"></a><span class="LectureNum">Lecture 26:</span> Hashing and Equality<span class="button-group"><a href="#(part._)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h4><p class="boxed">A fast data structure for finding data by a key; the full rules for equality in Java</p><h5 class="heading">26.1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction<span class="button-group"><a href="#(part._.Introduction)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p>In the past few lectures we&rsquo;ve talked about <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>, which is a data structure that provides particularly
efficient ways to access items at any position within a list.  But what if we need to look up data not by <span class="emph">position</span>,
but rather by some other type of key?  What can we do?  Let&rsquo;s examine two examples of such data.</p><h5 class="heading">26.1.1<tt>&nbsp;</tt><a name="(part._.Dictionaries)"></a>Dictionaries<span class="button-group"><a href="#(part._.Dictionaries)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">Suppose we need to represent a typical English dictionary, with words mapped to their meanings.  We might start
by defining a class to represent dictionary entries:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// Represents one word in a dictionary, together with its definition
</span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">DictEntry</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">word</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">meaning</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">We then need to represent a collection of these entries.  We have several choices of data structures to use to represent
this collection:
</div><div class="SIntrapara"><ul><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IList</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span>, with entries in no particular order</p></li><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IList</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span> that is <span class="emph">sorted</span> alphabetically by word</p></li><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Deque</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span>, with entries in no particular order</p></li><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Deque</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span> that is <span class="emph">sorted</span> alphabetically by word</p></li><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span>, with entries in no particular order</p></li><li><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">DictEntry</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span> that is <span class="emph">sorted</span> alphabetically by word</p></li><li><p>Binary trees of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">DictEntry</span><span class="RktMeta"></span></span></span></p></li><li><p>Binary search trees of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">DictEntry</span><span class="RktMeta"></span></span></span>, ordered alphabetically by word</p></li></ul></div></p><p>Let&rsquo;s consider what operations we&rsquo;ll typically perform on such a dictionary.  The single most important operation
on a dictionary of words is to <span class="emph">lookup</span> a word to find its definition, so ideally we want that operation to be as
fast as possible.</p><p>Right away, we can see that the unsorted <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IList</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Deque</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> and binary tree options
are woefully outmatched by their sorted versions: at the cost of maintaining the sort order,
we get far better algorithms to access the items.  (Of course, the overhead of maintaining the sorting order
may not be trivial, so if we can avoid that, so much the better.)</p><p>Some slightly more careful thought shows that both <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IList</span><span class="RktMeta"></span></span></span>s and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Deque</span><span class="RktMeta"></span></span></span>s are less effective than
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s, since we can (as we saw in <a href="lecture22.html" data-pltdoc="x">Lecture 22</a>) use binary search over indices to quickly
narrow in on a word, rather than plod our way through the list from front to back.</p><h5 class="heading">26.1.2<tt>&nbsp;</tt><a name="(part._.Wikis)"></a>Wikis<span class="button-group"><a href="#(part._.Wikis)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">A wiki is like a dictionary that anyone can edit.  Here, instead of words and meanings, we would have
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// Represents a Wiki entry
</span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">WikiEntry</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">url</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">contents</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">(Of course, in practice we would use more sophisticated classes to represent URLs and contents, but strings will suffice here.)
Here the performance tradeoffs are a bit less clear: we need the ability to quickly access an entry by its URL, and we need the ability
to quickly edit an entry, but we also need the ability to create or delete entries quickly, too.  Further, URLs don&rsquo;t have an obvious
ordering: technically we could sort them alphabetically, but that ordering is artificial.  Users of a wiki don&rsquo;t scan through
the entire wiki looking for the article they want; they search for the term or just type in the URL directly.</div></p><p>With this in mind, our best contenders above (the sorted <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> and the binary search trees) are looking less ideal.
Further, because we are now worried about creating and deleting entries, we have to worry about the cost of maintaining the
sort order.</p><h5 class="heading">26.2<tt>&nbsp;</tt><a name="(part._.Introducing_.Hash-tables)"></a>Introducing Hash-tables<span class="button-group"><a href="#(part._.Introducing_.Hash-tables)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p>Our goal is to design a data structure that gives us fast access to items when looked up by a <span class="emph">key</span>,
the ability to add, remove, and modify items, and preferably does not require that we impose a sort order
on the keys at all.  While we&rsquo;re choosing our requirements, we might as well generalize, and say that
this data structure should permit <span class="emph">any</span> kind of data as keys, and <span class="emph">any</span> kind of data as values.
A tall order! But it turns out to be possible &#8212;<wbr></wbr> let&rsquo;s see how.</p><p><div class="SIntrapara">Of all the data structures we have seen so far, only one of them gives us perfectly fast access to its
items: assuming we know what index to look for, an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> will simply let us <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">get</span><span class="RktMeta"></span></span></span> that item
instantly.  (We&rsquo;ll see in <a href="lecture27.html" data-pltdoc="x"><span class="LectureNum">Lecture 27:</span> Introduction to Big-<span style="font-style: italic">O</span> Analysis</a> more precisely what &ldquo;instantly&rdquo; means.)  If only we could somehow
<span class="emph">summarize</span> the key, and compute an index from it, then we could represent our dictionaries
and our wikis as
</div><div class="SIntrapara"><blockquote class="SCentered"><p><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s where the value for key \(k\) can be found at index \(summarize(k)\)</p></blockquote></div><div class="SIntrapara">where \(summarize\) is some function that takes a key and produces a non-negative integer.</div></p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>This isn&rsquo;t a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">DictEntry</span><span class="RktMeta"></span></span></span> or a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">WikiEntry</span><span class="RktMeta"></span></span></span> &#8212;<wbr></wbr>
but we did wish for an even-more-general structure of which dictionaries and wikis were just examples!</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">Let&rsquo;s see an example.  Suppose we wanted to record a mapping of professors&rsquo; names to their office numbers.
We need to record:
</div><div class="SIntrapara"><ul><li><p>Ben Lerner         ===&gt; WVH314</p></li><li><p>Leena Razzaq       ===&gt; WVH310B</p></li><li><p>Olin Shivers       ===&gt; WVH318</p></li><li><p>Matthias Felleisen ===&gt; WVH308B</p></li></ul></div></p><p><div class="SIntrapara">Suppose we picked the following as our \(summarize\) function:
</div><div class="SIntrapara"><blockquote class="SCentered"><p>\(summarize(name) =\) length in characters of the first name</p></blockquote></div><div class="SIntrapara">Then we pick as our data an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="ProfjKeyword">&lt;</span><span class="ProfjPrimType">String</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span> of length 10, and compute:
</div><div class="SIntrapara"><ul><li><p>&ldquo;Ben Lerner&rdquo; gets mapped to index 3</p></li><li><p>&ldquo;Leena Razzaq&rdquo; gets mapped to index 5</p></li><li><p>&ldquo;Olin Shivers&rdquo; gets mapped to index 4</p></li><li><p>&ldquo;Matthias Felleisen&rdquo; gets mapped to index 8</p></li></ul></div><div class="SIntrapara">so our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> will look like this:
</div><div class="SIntrapara"><pre class="SmallerVerb">index:     0     1     2       3        4        5       6     7       8        9
data:   [     |     |     | WVH314 | WVH318 | WVH310B |     |     | WVH308B |        ]</pre></div><div class="SIntrapara">This is amazingly efficient &#8212;<wbr></wbr> this one trick lets us get all the operations we want!
</div><div class="SIntrapara"><ul><li><p>To find the room number for a given professor, we simply compute the length of their name,
and go directly to that index in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>.</p></li><li><p>To modify the room number for a given professor, we again compute the length of their name,
and set the data at that index in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>.</p></li><li><p>To delete the information for a given professor, we again compute the length of their name,
and clear the data at that index from the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>.</p></li><li><p>Adding information for a new professor is no different than modifying information for that professor.</p></li></ul></div><div class="SIntrapara">Assuming that this &ldquo;summarize&rdquo; function is easy to compute, this is far faster than walking through a list, or even
a binary search tree.
</div><div class="SIntrapara"><blockquote class="IncerciseBody"><p><div class="SIntrapara"><p class="Incercise">Do Now!</p></div><div class="SIntrapara">What could possibly go wrong with the approach mentioned above?</div></p></blockquote></div></p><h5 class="heading">26.3<tt>&nbsp;</tt><a name="(part._.Introducing_.Hash.Maps)"></a>Introducing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>s<span class="button-group"><a href="#(part._.Introducing_.Hash.Maps)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">This data structure is so widely used that, like <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s, Java provides an implementation for us. It&rsquo;s called a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="ProfjKeyword">&lt;</span><span class="ProfjType">K</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">V</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span>,
and it&rsquo;s a generic data type that is parameterized by the type <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">K</span><span class="RktMeta"></span></span></span> of <span class="emph">keys</span> and the type <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">V</span><span class="RktMeta"></span></span></span> of <span class="emph">values</span>.
Accordingly, each of our examples above would be represented as <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="ProfjKeyword">&lt;</span><span class="ProfjPrimType">String</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">String</span><span class="ProfjKeyword">&gt;</span><span class="RktMeta"></span></span></span>, where the first <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">String</span><span class="RktMeta"></span></span></span> represents
words, urls or professor names, and the second <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">String</span><span class="RktMeta"></span></span></span> represents meanings, contents, or room assignments respectively.
A <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> <span class="emph">maps</span> keys to values.  (Note: To use a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>, we need to include the line
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">import</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">java</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">util</span><span class="ProfjDefault">.</span><span class="ProfjType">HashMap</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">at the top of each file that uses them, just like we needed to do to use <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s.)</div></p><p>But how does Java decide what to use for the &ldquo;summarize&rdquo; function?  In Java, every class implicitly extends a common base class called <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span>.
(If we define a class that explicitly extends another class, then <span class="emph">that</span> base class eventually extends <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span>.)
Because of this, every object type inherits a method called <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span>,
which simply returns an integer.  (This is also why every class has a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">toString</span><span class="RktMeta"></span></span></span> method, and various other methods we haven&rsquo;t
needed to examine in this course.)  Java even provides a default implementation of this method for us.  A <span class="emph">hash code</span> is simply a
summarization of a piece of data as a number, and the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> method is a <span class="emph">hash function</span> that computes this
hash code for us.  There is a very important caveat about <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span>, which will be <a href="#%28part._hashcodes%29" data-pltdoc="x">discussed below</a>.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>And in fact, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>s <span class="emph">don&rsquo;t</span> use <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s directly, but rather use something similar
that&rsquo;s a bit more efficient yet.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">Note that externally, we cannot see that a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> uses an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> as its internal data, just like externally we could
not see that our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Deque</span><span class="RktMeta"></span></span></span>s used <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Sentinel</span><span class="RktMeta"></span></span></span>s and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Node</span><span class="RktMeta"></span></span></span>s internally.  All we know is the methods available on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>.</div></p><p><div class="SIntrapara">We can build and use our example room-assignments as follows:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">ExampleHashMaps</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">void</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">testHashMaps</span><span class="ProfjKeyword">(</span><span class="ProfjType">Tester</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">t</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjType">HashMap</span><span class="ProfjKeyword">&lt;</span><span class="ProfjPrimType">String</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">String</span><span class="ProfjKeyword">&gt;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">rooms</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">HashMap</span><span class="ProfjKeyword">&lt;</span><span class="ProfjPrimType">String</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">String</span><span class="ProfjKeyword">&gt;</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjComment">// Put all the data into the hashtable
</span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">put</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Ben Lerner"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH314"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">put</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Leena Razzaq"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH310B"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">put</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Olin Shivers"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH308"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">put</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Matthias Felleisen"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH308B"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjComment">// Get the data
</span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">get</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Ben Lerner"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH314"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">get</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Olin Shivers"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjString">"WVH310B"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjComment">// Check that some data is present
</span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">containsKey</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Leena Razzaq"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">true</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">containsKey</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Amal Ahmed"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjComment">// Data that isn't present will return null
</span><span class="ProfjWhiteSpace">    </span><span class="ProfjIdentifier">t</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">checkExpect</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">rooms</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">get</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Amal Ahmed"</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">null</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div></p><p>Because adding and setting values for a key are essentially the same operation, this action was named <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">put</span><span class="RktMeta"></span></span></span> (to contrast it with <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">get</span><span class="RktMeta"></span></span></span>), rather than
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">add</span><span class="RktMeta"></span></span></span>.  (It may help to understand the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> methods by noticing that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">add</span><span class="RktMeta"></span></span></span> on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s is almost exactly like <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">put</span><span class="RktMeta"></span></span></span>
on <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>s, except the &ldquo;key&rdquo; type is required to be an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">int</span><span class="RktMeta"></span></span></span>.)</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Also note the additional method <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">containsKey</span><span class="RktMeta"></span></span></span>, which tells us whether a key is present in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> or not.  This is crucially important
if you ever design a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> that stores the value <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">null</span><span class="RktMeta"></span></span></span> &#8212;<wbr></wbr> thanks to an old design decision, the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">get</span><span class="RktMeta"></span></span></span> method will <span class="emph">not throw an error</span>
if a key is not found, but instead will return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">null</span><span class="RktMeta"></span></span></span>.  Accordingly, the only way to distinguish if a returned value of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">null</span><span class="RktMeta"></span></span></span> means
the key wasn&rsquo;t actually present is to use <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">containsKey</span><span class="RktMeta"></span></span></span>.  But why would you deliberately store <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">null</span><span class="RktMeta"></span></span></span> in a <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span>?</p></blockquote></blockquote></blockquote><h5 class="heading">26.4<tt>&nbsp;</tt><a name="(part._.Hash_collisions)"></a>Hash collisions<span class="button-group"><a href="#(part._.Hash_collisions)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">Let&rsquo;s go back to our example implementation of a hash table.  Suppose we want to add another professor:
</div><div class="SIntrapara"><ul><li><p>Amal Ahmed         ===&gt; WVH328</p></li></ul></div><div class="SIntrapara">According to our rules, we compute the length of her first name, and go to index 4 in the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>...but it&rsquo;s already
occupied!  This is called a <span class="emph">collision</span>, and it&rsquo;s a rather critical problem.  After all, we can&rsquo;t assume that every person
in our table will have a first name of a unique length!</div></p><p>There are several ways to solve this problem, and we will not discuss them in exhaustive detail here: we sketch out the space of
possibilities just to illustrate how creative (and complex!) the solutions can get.  The first way is simply to
choose a better hash function that avoids more collisions.  But collisions are inevitable: there are a lot of names, and only a
few positions in our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>, and eventually it will be full.  The second way is simply to make the
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> bigger to begin with, so there is more space.  But this may be wasteful, if most of those locations are empty.</p><p>The remaining ways to solve collisions require that we store both the key and the value in our data structure, as opposed to
just the values (and using the keys only to compute indices).
The third way to solve collisions is by <span class="emph">probing</span>, which says &ldquo;Compute the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> of the key.  If that
index is already used by some other data, then look at the next index, and keep going until you find a free index.&rdquo;
In our example, &ldquo;Amal Ahmed&rdquo; hashes to index 4, which is full, and so is index 5.  But index 6 is free, so Amal&rsquo;s
room number would be placed there.  This approach works for a little while, but after ten items are inserted into our
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>, it is completely full, and everything will collide and nothing will find a place!</p><p>The fourth way is called <span class="emph">chaining</span>, and replaces our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> of values with an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> of <span class="emph"><span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span>s of values</span>.
Each inner list, or <span class="emph">bucket</span>, can hold all the values it needs to.  Of course, this eventually defeats the purpose of having a hash table in the first
place: we have to scan that inner list.</p><p>The fifth way is called <span class="emph">rehashing</span>, and essentially uses that inner <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">ArrayList</span><span class="RktMeta"></span></span></span> as another hash table, using a different hash function
so that the inner table doesn&rsquo;t immediately fill with collisions.  This requires additional implementation effort beyond the built-in support
in Java, and is not a general-purpose solution.</p><p>Finally, when all else fails, we can resize the hashtable on demand.  This is an expensive operation, but if done sporadically,
can be the most efficient solution of them all.</p><h5 class="heading">26.5<tt>&nbsp;</tt><a name="(part._hashcodes)"></a>Hash codes and equality<span class="button-group"><a href="#(part._hashcodes)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p>There is a crucial rule that must be followed regarding hash codes.  The built-in <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">HashMap</span><span class="RktMeta"></span></span></span> computes the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> of a key,
and then examines the various keys with that hash code to see which one is equal, and returns the corresponding value.  This begs the question:
<span class="emph">what happens when we want to define our own equality?</span></p><p><div class="SIntrapara">Until this point, we have defined our own equality methods as <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> or <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameList</span><span class="RktMeta"></span></span></span> or <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameTree</span><span class="RktMeta"></span></span></span>, when there&rsquo;s a perfectly
good name, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span>, waiting to be used!  We could easily override the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> method, but there is a catch: we must then also
override the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> method to match.  Any two objects that are equal according to the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> method must also have equal
hash codes.  This is crucial, and seems backwards at times, so let&rsquo;s be explicit:
</div><div class="SIntrapara"><ul><li><p>If we override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> such that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">objB</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> is true, then we must also override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> to ensure that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">objB</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>.</p></li><li><p>If we override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> such that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">objB</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> is false, then <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objB</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> may or may not be the same.</p></li><li><p>If we override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> such that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">!=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">objB</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>, then we must also override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> to ensure that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">objB</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> is false.</p></li><li><p>If we override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> such that <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">objB</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>, then <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">objA</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">objB</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> may or may not be true.</p></li></ul></div></p><h5 class="heading">26.5.1<tt>&nbsp;</tt><a name="(part._.Defining_custom_hash.Codes)"></a>Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span>s<span class="button-group"><a href="#(part._.Defining_custom_hash.Codes)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">Suppose we wanted to define a custom hash code for our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Book</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Author</span><span class="RktMeta"></span></span></span> classes: we could do so as follows:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Book</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">Author</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">author</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">title</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">year</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">author</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">*</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">10000</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">+</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">year</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Author</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">Book</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">book</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">String</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">name</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">yob</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">    </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">name</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">hashCode</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">*</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">10000</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">+</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">yob</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">We pick the constant 10000 since years (at least for the foreseeable future!) are numbers less than that.  Notice that the hash code for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Author</span><span class="RktMeta"></span></span></span>s
does not include any information about the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">book</span><span class="RktMeta"></span></span></span> field in its computation (because otherwise we&rsquo;d have
infinite recursion), but this does not violate our rules above.</div></p><h5 class="heading">26.5.2<tt>&nbsp;</tt><a name="(part._.Defining_custom_equals_methods_for_simple_classes)"></a>Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for simple classes<span class="button-group"><a href="#(part._.Defining_custom_equals_methods_for_simple_classes)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p><div class="SIntrapara">The <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> method is ultimately inherited from the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span> class.  Accordingly,
the signature for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> must work for any object at all (unlike our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameBook</span><span class="RktMeta"></span></span></span> or <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> methods), so it looks like
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">other</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">If we want to override the default behavior of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span>, then we must implement exactly this signature.  But because
the type of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">other</span><span class="RktMeta"></span></span></span> is merely <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span>, we don&rsquo;t know anything about it, and so cannot make progress.  We will need to cast
from <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span> to the particular class we are in.
<span style="font-weight: bold"><span class="emph">This is the one and only valid use of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">instanceof</span><span class="RktMeta"></span></span></span> and casting in this entire course!  It is both sufficient to
let us implement our equality method, and necessary because the types are otherwise uninformative.</span></span>
Here are properly-implemented custom equality methods for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Book</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Author</span><span class="RktMeta"></span></span></span>:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// In Book
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">other</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">if</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">!</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">other</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">instanceof</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Book</span><span class="ProfjKeyword">)</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjComment">// this cast is safe, because we just checked instanceof
</span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">Book</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjType">Book</span><span class="ProfjKeyword">)</span><span class="ProfjIdentifier">other</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">author</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">author</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">      </span><span class="ProfjKeyword">&amp;&amp;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">year</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">year</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">      </span><span class="ProfjKeyword">&amp;&amp;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">title</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">title</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// In Author
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">other</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">if</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">!</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">other</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">instanceof</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Author</span><span class="ProfjKeyword">)</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjComment">// this cast is safe, because we just checked instanceof
</span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">Author</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjType">Author</span><span class="ProfjKeyword">)</span><span class="ProfjIdentifier">other</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">name</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">name</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">      </span><span class="ProfjKeyword">&amp;&amp;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">yob</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">yob</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div></p><p><div class="SIntrapara">The fields that are used in computing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span>s must be a subset of the fields used for computing <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> &#8212;<wbr></wbr> or else we could violate
the rule above relating hashcodes and equality.
</div><div class="SIntrapara"><blockquote class="ExerciseBody"><p><div class="SIntrapara"><p class="Exercise">Exercise</p></div><div class="SIntrapara">Design faulty <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">hashCode</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Book</span><span class="RktMeta"></span></span></span>, such that two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Book</span><span class="RktMeta"></span></span></span>s could have different
hashcodes and yet still be equal.</div></p></blockquote></div></p><p><div class="SIntrapara">Note that if you implement an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> method with any signature other than the one above, Java will not complain!  <span class="emph">But,</span>
your program also will not run as you might expect.  Remind yourself of the properties we want in an equality relation.
Suppose we defined our <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Author</span><span class="RktMeta"></span></span></span> class to have the following method, with a too-specific signature:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// In Author
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjType">Author</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">name</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">name</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">      </span><span class="ProfjKeyword">&amp;&amp;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">yob</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">yob</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">And suppose we had the following two example objects:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjType">Author</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">author1</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Author</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Bill Nye"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">1955</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">author2</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">new</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Author</span><span class="ProfjKeyword">(</span><span class="ProfjString">"Bill Nye"</span><span class="ProfjDefault">,</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">1955</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">If we check whether <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">author1</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">author2</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span>, we would <span class="emph">like</span> the answer to be <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">true</span><span class="RktMeta"></span></span></span>.  But since
<span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">author2</span><span class="RktMeta"></span></span></span> is declared to be of type <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span>, Java will look for a method with signature <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">other</span><span class="ProfjKeyword">)</span><span class="RktMeta"></span></span></span> &#8212;<wbr></wbr> and we didn&rsquo;t define
any such method!  Instead, we get the default implementation of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span>, from the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjPrimType">Object</span><span class="RktMeta"></span></span></span> class, and it will return <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjLiteral">false</span><span class="RktMeta"></span></span></span>.
This sort of subtle bug is hard to detect; our autograders will warn you if you get this wrong, but Eclipse will not.  Be alert!</div></p><h5 class="heading">26.5.3<tt>&nbsp;</tt><a name="(part._.Defining_custom_equals_methods_for_itemizations)"></a>Defining custom <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for itemizations<span class="button-group"><a href="#(part._.Defining_custom_equals_methods_for_itemizations)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h5><p>If we want to define customized equality testing for itemizations, we obviously can&rsquo;t throw away the hard-won correct behavior of our sameness-testing
methods from <a href="lecture12.html" data-pltdoc="x"><span class="LectureNum">Lecture 12:</span> Defining sameness for complex data, part 2</a>.  In particular, we know that using <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">instanceof</span><span class="RktMeta"></span></span></span> is <span class="emph">not</span> sufficient in the presence of
inheritance.  But we also are forced to use the signature for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> given above.</p><p><div class="SIntrapara">The solution in this case is a &ldquo;hybrid&rdquo; of the code above and the double-dispatch technique of <a href="lecture12.html" data-pltdoc="x">Lecture 12</a>.  In fact, we do not even need to
rewrite that code; we just add to it.  Recall our definition of <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, for example, and the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">AShape</span><span class="RktMeta"></span></span></span> abstract base class:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">interface</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">abstract</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">implements</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameSquare</span><span class="ProfjKeyword">(</span><span class="ProfjType">Square</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameRect</span><span class="ProfjKeyword">(</span><span class="ProfjType">Rect</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace">     </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">class</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">extends</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">AShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">radius</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">Circle</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">int</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">radius</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">radius</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">radius</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">this</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">sameCircle</span><span class="ProfjKeyword">(</span><span class="ProfjType">Circle</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">radius</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">==</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">radius</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">We have here a suite of methods that are perfectly suited to determining when two <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span>s are the same or not.
We merely need to cause the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> methods for shapes to delegate into those methods.
</div><div class="SIntrapara"><blockquote class="IncerciseBody"><p><div class="SIntrapara"><p class="Incercise">Do Now!</p></div><div class="SIntrapara">Design a <span class="emph">single</span> implementation for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> that will suffice for <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> and <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span>.</div></p></blockquote></div><div class="SIntrapara">All we need to do is override <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> on the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">AShape</span><span class="RktMeta"></span></span></span> base class, as follows:
</div><div class="SIntrapara"><div class="JavaHighlightBlock"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="ProfjComment">// In AShape
</span><span class="ProfjKeyword">public</span><span class="ProfjWhiteSpace"> </span><span class="ProfjPrimType">boolean</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">equals</span><span class="ProfjKeyword">(</span><span class="ProfjPrimType">Object</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">other</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">if</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjKeyword">!</span><span class="ProfjIdentifier">other</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">instanceof</span><span class="ProfjWhiteSpace"> </span><span class="ProfjType">IShape</span><span class="ProfjKeyword">)</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">{</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjLiteral">false</span><span class="ProfjDefault">;</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjComment">// this cast is safe, because we just checked instanceof
</span><span class="ProfjWhiteSpace">  </span><span class="ProfjType">IShape</span><span class="ProfjWhiteSpace"> </span><span class="ProfjIdentifier">that</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">=</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">(</span><span class="ProfjType">IShape</span><span class="ProfjKeyword">)</span><span class="ProfjIdentifier">other</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjWhiteSpace">  </span><span class="ProfjKeyword">return</span><span class="ProfjWhiteSpace"> </span><span class="ProfjKeyword">this</span><span class="ProfjDefault">.</span><span class="ProfjIdentifier">sameShape</span><span class="ProfjKeyword">(</span><span class="ProfjIdentifier">that</span><span class="ProfjKeyword">)</span><span class="ProfjDefault">;</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="ProfjKeyword">}</span><span class="RktMeta"></span></td></tr></table></blockquote></div></div><div class="SIntrapara">Now any <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Circle</span><span class="RktMeta"></span></span></span>, <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Square</span><span class="RktMeta"></span></span></span> or <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">Rect</span><span class="RktMeta"></span></span></span> object will inherit its <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span> method from <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">AShape</span><span class="RktMeta"></span></span></span>,
and that method first checks that the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">other</span><span class="RktMeta"></span></span></span> object is at least an <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span> (or else it&rsquo;s definitely not equal to <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjKeyword">this</span><span class="RktMeta"></span></span></span> object!),
and then casts down to <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjType">IShape</span><span class="RktMeta"></span></span></span> and delegates to the <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">sameShape</span><span class="RktMeta"></span></span></span> method, which implements the double-dispatch technique for sameness testing
that we worked out already.
</div><div class="SIntrapara"><blockquote class="IncerciseBody"><p><div class="SIntrapara"><p class="Incercise">Do Now!</p></div><div class="SIntrapara">Now that we&rsquo;ve overridden <span class="RktBlk"><span class="JavaHighlight"><span class="RktMeta"></span><span class="ProfjIdentifier">equals</span><span class="RktMeta"></span></span></span>, our shape classes have violated an important principle.  What principle is it?  Fix it!</div></p></blockquote></div></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="lecture25.html" title="backward to &quot;Lecture 25: Iterator and Iterable&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="Lectures.html" title="up to &quot;Lectures&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lecture27.html" title="forward to &quot;Lecture 27: Introduction to Big-O Analysis&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>